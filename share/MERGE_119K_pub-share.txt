===MERGE_INFO:folder=pub-share===

===FILE:public\index.html===
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ShareTools</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Fira+Code:wght@400;500;600&family=Source+Code+Pro:wght@400;500;600;700&family=Ubuntu+Mono:wght@400;700&family=Space+Mono:wght@400;700&family=VT323&family=Press+Start+2P&family=Courier+Prime:wght@400;700&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    /* ==================== DEFAULT STYLE ==================== */
    :root, [data-style="default"] {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-card: #1a1a24;
      --bg-card-hover: #22222e;
      --accent-primary: #6366f1;
      --accent-secondary: #818cf8;
      --accent-success: #10b981;
      --accent-warning: #f59e0b;
      --accent-error: #ef4444;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      --border-color: #2d2d3a;
      --glass-bg: rgba(26, 26, 36, 0.8);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      --font-display: 'Outfit', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --glow-primary: 0 4px 16px rgba(99, 102, 241, 0.3);
      --glow-success: 0 4px 16px rgba(16, 185, 129, 0.3);
      --bg-image: radial-gradient(ellipse 80% 50% at 20% -20%, rgba(99, 102, 241, 0.15), transparent),
                  radial-gradient(ellipse 60% 40% at 80% 100%, rgba(16, 185, 129, 0.1), transparent);
    }

    /* ==================== LIGHT THEME OVERRIDE ==================== */
    [data-theme="light"] {
      --bg-primary: #f8fafc;
      --bg-secondary: #f1f5f9;
      --bg-card: #ffffff;
      --bg-card-hover: #f8fafc;
      --accent-primary: #4f46e5;
      --accent-secondary: #6366f1;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-muted: #94a3b8;
      --border-color: #e2e8f0;
      --glass-bg: rgba(255, 255, 255, 0.9);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
      --bg-image: radial-gradient(ellipse 80% 50% at 20% -20%, rgba(79, 70, 229, 0.1), transparent),
                  radial-gradient(ellipse 60% 40% at 80% 100%, rgba(16, 185, 129, 0.08), transparent);
    }

    /* ==================== CYBERPUNK STYLE ==================== */
    [data-style="cyberpunk"] {
      --bg-primary: #0a0e14;
      --bg-secondary: #0d1117;
      --bg-card: #1a2332;
      --bg-card-hover: #243044;
      --accent-primary: #00fff5;
      --accent-secondary: #ff00ff;
      --accent-success: #39ff14;
      --accent-warning: #ff6b00;
      --accent-error: #ff3366;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #484f58;
      --border-color: #30363d;
      --glass-bg: #1a2332;
      --glow-primary: 0 0 20px rgba(0, 255, 245, 0.4);
      --glow-success: 0 0 20px rgba(57, 255, 20, 0.4);
      --font-display: 'Orbitron', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 4px;
      --radius-md: 6px;
      --radius-lg: 8px;
      --bg-image: linear-gradient(90deg, rgba(0, 255, 245, 0.03) 1px, transparent 1px),
                  linear-gradient(rgba(0, 255, 245, 0.03) 1px, transparent 1px),
                  radial-gradient(ellipse 80% 50% at 50% -20%, rgba(255, 0, 255, 0.15), transparent),
                  radial-gradient(ellipse 60% 40% at 80% 100%, rgba(0, 255, 245, 0.1), transparent);
      --bg-size: 50px 50px, 50px 50px, 100% 100%, 100% 100%;
    }

    /* ==================== RETRO TERMINAL STYLE ==================== */
    [data-style="retro"] {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-card: #21262d;
      --bg-card-hover: #30363d;
      --accent-primary: #58a6ff;
      --accent-secondary: #7ee787;
      --accent-success: #3fb950;
      --accent-warning: #d29922;
      --accent-error: #f85149;
      --text-primary: #c9d1d9;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --border-color: #30363d;
      --glass-bg: #21262d;
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);
      --glow-primary: 0 0 10px rgba(88, 166, 255, 0.3);
      --glow-success: 0 0 10px rgba(63, 185, 80, 0.3);
      --font-display: 'Fira Code', monospace;
      --font-mono: 'Fira Code', monospace;
      --radius-sm: 2px;
      --radius-md: 4px;
      --radius-lg: 6px;
      --bg-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(88, 166, 255, 0.03) 2px, rgba(88, 166, 255, 0.03) 4px);
    }

    /* ==================== NORD STYLE ==================== */
    [data-style="nord"] {
      --bg-primary: #2e3440;
      --bg-secondary: #3b4252;
      --bg-card: #434c5e;
      --bg-card-hover: #4c566a;
      --accent-primary: #88c0d0;
      --accent-secondary: #81a1c1;
      --accent-success: #a3be8c;
      --accent-warning: #ebcb8b;
      --accent-error: #bf616a;
      --text-primary: #eceff4;
      --text-secondary: #d8dee9;
      --text-muted: #8fbcbb;
      --border-color: #4c566a;
      --glass-bg: rgba(67, 76, 94, 0.9);
      --shadow-lg: 0 15px 35px rgba(0, 0, 0, 0.3);
      --glow-primary: 0 4px 15px rgba(136, 192, 208, 0.2);
      --glow-success: 0 4px 15px rgba(163, 190, 140, 0.2);
      --font-display: 'JetBrains Mono', monospace;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --bg-image: radial-gradient(ellipse 100% 80% at 20% 0%, rgba(136, 192, 208, 0.1), transparent),
                  radial-gradient(ellipse 80% 60% at 80% 100%, rgba(129, 161, 193, 0.1), transparent);
    }

    /* ==================== DRACULA STYLE ==================== */
    [data-style="dracula"] {
      --bg-primary: #21222c;
      --bg-secondary: #282a36;
      --bg-card: #343746;
      --bg-card-hover: #3e4155;
      --accent-primary: #bd93f9;
      --accent-secondary: #ff79c6;
      --accent-success: #50fa7b;
      --accent-warning: #f1fa8c;
      --accent-error: #ff5555;
      --text-primary: #f8f8f2;
      --text-secondary: #bfbebe;
      --text-muted: #6272a4;
      --border-color: #44475a;
      --glass-bg: rgba(52, 55, 70, 0.9);
      --shadow-lg: 0 15px 40px rgba(0, 0, 0, 0.4);
      --glow-primary: 0 4px 20px rgba(189, 147, 249, 0.3);
      --glow-success: 0 4px 20px rgba(80, 250, 123, 0.3);
      --font-display: 'JetBrains Mono', monospace;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 14px;
      --bg-image: radial-gradient(ellipse 90% 60% at 10% -10%, rgba(189, 147, 249, 0.12), transparent),
                  radial-gradient(ellipse 70% 50% at 90% 110%, rgba(255, 121, 198, 0.08), transparent);
    }

    /* ==================== SYNTHWAVE STYLE ==================== */
    [data-style="synthwave"] {
      --bg-primary: #1a1a2e;
      --bg-secondary: #16213e;
      --bg-card: #1f2940;
      --bg-card-hover: #283250;
      --accent-primary: #ff2a6d;
      --accent-secondary: #05d9e8;
      --accent-success: #01ffc3;
      --accent-warning: #ffcc00;
      --accent-error: #ff073a;
      --text-primary: #e8e8e8;
      --text-secondary: #b8b8b8;
      --text-muted: #6c6c6c;
      --border-color: #2d3a5a;
      --glass-bg: rgba(31, 41, 64, 0.95);
      --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.5);
      --glow-primary: 0 0 25px rgba(255, 42, 109, 0.4);
      --glow-success: 0 0 25px rgba(1, 255, 195, 0.4);
      --font-display: 'Orbitron', sans-serif;
      --font-mono: 'Space Mono', monospace;
      --radius-sm: 4px;
      --radius-md: 6px;
      --radius-lg: 10px;
      --bg-image: linear-gradient(180deg, transparent 0%, rgba(255, 42, 109, 0.05) 100%),
                  linear-gradient(to right, rgba(5, 217, 232, 0.1) 1px, transparent 1px),
                  linear-gradient(rgba(5, 217, 232, 0.1) 1px, transparent 1px);
      --bg-size: 100% 100%, 40px 40px, 40px 40px;
    }

    /* ==================== MATRIX STYLE ==================== */
    [data-style="matrix"] {
      --bg-primary: #000000;
      --bg-secondary: #0a0a0a;
      --bg-card: #0f0f0f;
      --bg-card-hover: #141414;
      --accent-primary: #00ff00;
      --accent-secondary: #00cc00;
      --accent-success: #00ff00;
      --accent-warning: #ffff00;
      --accent-error: #ff0000;
      --text-primary: #00ff00;
      --text-secondary: #00dd00;
      --text-muted: #009900;
      --border-color: #003300;
      --glass-bg: rgba(0, 20, 0, 0.9);
      --shadow-lg: 0 10px 30px rgba(0, 50, 0, 0.5);
      --glow-primary: 0 0 15px rgba(0, 255, 0, 0.5);
      --glow-success: 0 0 15px rgba(0, 255, 0, 0.5);
      --font-display: 'VT323', monospace;
      --font-mono: 'VT323', monospace;
      --radius-sm: 0px;
      --radius-md: 0px;
      --radius-lg: 0px;
      --bg-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 255, 0, 0.03) 2px, rgba(0, 255, 0, 0.03) 4px);
    }

    /* ==================== SUNSET STYLE ==================== */
    [data-style="sunset"] {
      --bg-primary: #1a0a0f;
      --bg-secondary: #2d1520;
      --bg-card: #3d1d2a;
      --bg-card-hover: #4d2535;
      --accent-primary: #ff6b6b;
      --accent-secondary: #ffa07a;
      --accent-success: #90ee90;
      --accent-warning: #ffd700;
      --accent-error: #dc143c;
      --text-primary: #fff5f5;
      --text-secondary: #e8d0d0;
      --text-muted: #a89090;
      --border-color: #5d2d3d;
      --glass-bg: rgba(61, 29, 42, 0.9);
      --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.4);
      --glow-primary: 0 4px 20px rgba(255, 107, 107, 0.3);
      --glow-success: 0 4px 20px rgba(144, 238, 144, 0.3);
      --font-display: 'Ubuntu Mono', monospace;
      --font-mono: 'Ubuntu Mono', monospace;
      --radius-sm: 8px;
      --radius-md: 14px;
      --radius-lg: 22px;
      --bg-image: radial-gradient(ellipse 100% 80% at 0% 0%, rgba(255, 107, 107, 0.15), transparent),
                  radial-gradient(ellipse 80% 60% at 100% 100%, rgba(255, 160, 122, 0.1), transparent);
    }

    /* ==================== OCEAN STYLE ==================== */
    [data-style="ocean"] {
      --bg-primary: #0a1628;
      --bg-secondary: #0f2847;
      --bg-card: #163a66;
      --bg-card-hover: #1d4a85;
      --accent-primary: #00d4ff;
      --accent-secondary: #0099cc;
      --accent-success: #00ff88;
      --accent-warning: #ffaa00;
      --accent-error: #ff4466;
      --text-primary: #e6f4ff;
      --text-secondary: #b3d9ff;
      --text-muted: #6699cc;
      --border-color: #1d4a75;
      --glass-bg: rgba(22, 58, 102, 0.9);
      --shadow-lg: 0 20px 50px rgba(0, 20, 40, 0.5);
      --glow-primary: 0 4px 25px rgba(0, 212, 255, 0.3);
      --glow-success: 0 4px 25px rgba(0, 255, 136, 0.3);
      --font-display: 'IBM Plex Mono', monospace;
      --font-mono: 'IBM Plex Mono', monospace;
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --bg-image: radial-gradient(ellipse 100% 100% at 0% 0%, rgba(0, 212, 255, 0.1), transparent),
                  radial-gradient(ellipse 60% 40% at 100% 100%, rgba(0, 153, 204, 0.08), transparent),
                  linear-gradient(180deg, transparent 0%, rgba(0, 212, 255, 0.02) 100%);
    }

    /* ==================== FOREST STYLE ==================== */
    [data-style="forest"] {
      --bg-primary: #0a1a0f;
      --bg-secondary: #122a16;
      --bg-card: #1a3d20;
      --bg-card-hover: #22502a;
      --accent-primary: #4ade80;
      --accent-secondary: #22c55e;
      --accent-success: #16a34a;
      --accent-warning: #facc15;
      --accent-error: #dc2626;
      --text-primary: #f0fdf4;
      --text-secondary: #dcfce7;
      --text-muted: #86efac;
      --border-color: #2d5a35;
      --glass-bg: rgba(26, 61, 32, 0.9);
      --shadow-lg: 0 20px 50px rgba(0, 30, 15, 0.5);
      --glow-primary: 0 4px 20px rgba(74, 222, 128, 0.25);
      --glow-success: 0 4px 20px rgba(34, 197, 94, 0.25);
      --font-display: 'Source Code Pro', monospace;
      --font-mono: 'Source Code Pro', monospace;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 18px;
      --bg-image: radial-gradient(ellipse 100% 80% at 20% -10%, rgba(74, 222, 128, 0.08), transparent),
                  radial-gradient(ellipse 60% 50% at 90% 110%, rgba(34, 197, 94, 0.06), transparent);
    }

    /* ==================== CANDY STYLE ==================== */
    [data-style="candy"] {
      --bg-primary: #1e1528;
      --bg-secondary: #2a1f38;
      --bg-card: #382a48;
      --bg-card-hover: #463558;
      --accent-primary: #c084fc;
      --accent-secondary: #f472b6;
      --accent-success: #6ee7b7;
      --accent-warning: #fcd34d;
      --accent-error: #f87171;
      --text-primary: #faf5ff;
      --text-secondary: #e9d5ec;
      --text-muted: #c4b5d8;
      --border-color: #4a3b5c;
      --glass-bg: rgba(56, 42, 72, 0.85);
      --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.4);
      --glow-primary: 0 4px 20px rgba(192, 132, 252, 0.3);
      --glow-success: 0 4px 20px rgba(110, 231, 183, 0.3);
      --font-display: 'Outfit', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 12px;
      --radius-md: 18px;
      --radius-lg: 28px;
      --bg-image: radial-gradient(ellipse 80% 60% at 20% -10%, rgba(192, 132, 252, 0.15), transparent),
                  radial-gradient(ellipse 70% 50% at 85% 110%, rgba(244, 114, 182, 0.12), transparent);
    }

    /* ==================== HACKER STYLE ==================== */
    [data-style="hacker"] {
      --bg-primary: #0d0d0d;
      --bg-secondary: #1a1a1a;
      --bg-card: #262626;
      --bg-card-hover: #333333;
      --accent-primary: #00ff41;
      --accent-secondary: #008F11;
      --accent-success: #00ff41;
      --accent-warning: #ffff00;
      --accent-error: #ff0000;
      --text-primary: #00ff41;
      --text-secondary: #00cc33;
      --text-muted: #008F11;
      --border-color: #333333;
      --glass-bg: rgba(38, 38, 38, 0.9);
      --shadow-lg: 0 10px 30px rgba(0, 40, 0, 0.4);
      --glow-primary: 0 0 15px rgba(0, 255, 65, 0.4);
      --glow-success: 0 0 15px rgba(0, 255, 65, 0.4);
      --font-display: 'Courier Prime', monospace;
      --font-mono: 'Courier Prime', monospace;
      --radius-sm: 0px;
      --radius-md: 2px;
      --radius-lg: 4px;
      --bg-image: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(0, 255, 65, 0.03) 1px, rgba(0, 255, 65, 0.03) 2px);
    }

    /* ==================== PIXEL STYLE ==================== */
    [data-style="pixel"] {
      --bg-primary: #1a1c2c;
      --bg-secondary: #292b3d;
      --bg-card: #3b4058;
      --bg-card-hover: #4d5273;
      --accent-primary: #f4f4f4;
      --accent-secondary: #94b0c2;
      --accent-success: #57ff57;
      --accent-warning: #ffcc00;
      --accent-error: #ff5555;
      --text-primary: #f4f4f4;
      --text-secondary: #c8cfd8;
      --text-muted: #6c7589;
      --border-color: #566173;
      --glass-bg: rgba(59, 64, 88, 0.95);
      --shadow-lg: 0 8px 0 rgba(0, 0, 0, 0.3);
      --glow-primary: none;
      --glow-success: none;
      --font-display: 'Press Start 2P', cursive;
      --font-mono: 'Press Start 2P', cursive;
      --radius-sm: 0px;
      --radius-md: 0px;
      --radius-lg: 0px;
      --bg-image: linear-gradient(rgba(26, 28, 44, 0.95), rgba(26, 28, 44, 0.95)),
                  repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255, 255, 255, 0.02) 2px, rgba(255, 255, 255, 0.02) 4px);
    }

    /* ==================== NEON PINK STYLE ==================== */
    [data-style="neonpink"] {
      --bg-primary: #0f0014;
      --bg-secondary: #1a0024;
      --bg-card: #2a0038;
      --bg-card-hover: #3a004c;
      --accent-primary: #ff0080;
      --accent-secondary: #ff00ff;
      --accent-success: #00ff80;
      --accent-warning: #ff8000;
      --accent-error: #ff0040;
      --text-primary: #ffe6f2;
      --text-secondary: #ffccdd;
      --text-muted: #cc88aa;
      --border-color: #4a0068;
      --glass-bg: rgba(42, 0, 56, 0.9);
      --shadow-lg: 0 20px 50px rgba(60, 0, 80, 0.5);
      --glow-primary: 0 0 30px rgba(255, 0, 128, 0.4);
      --glow-success: 0 0 30px rgba(0, 255, 128, 0.4);
      --font-display: 'Orbitron', sans-serif;
      --font-mono: 'Orbitron', sans-serif;
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 14px;
      --bg-image: radial-gradient(ellipse 100% 80% at 50% -20%, rgba(255, 0, 128, 0.2), transparent),
                  radial-gradient(ellipse 60% 40% at 80% 120%, rgba(255, 0, 255, 0.1), transparent);
    }

    /* ==================== SHARED STYLES ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-mono);
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      transition: all 0.3s ease;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-image);
      background-size: var(--bg-size, 100% 100%);
      pointer-events: none;
      z-index: 0;
    }

    [data-style="matrix"] body::before,
    [data-style="hacker"] body::before {
      animation: scanlines 0.1s linear infinite;
    }

    @keyframes scanlines {
      0% { transform: translateY(0); }
      100% { transform: translateY(2px); }
    }

    .container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 20px 24px;
      position: relative;
      z-index: 1;
    }

    header {
      text-align: center;
      margin-bottom: 24px;
      padding: 32px 0;
      position: relative;
    }

    [data-style="cyberpunk"] header::after,
    [data-style="synthwave"] header::after,
    [data-style="neonpink"] header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60%;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: var(--glow-primary);
      transition: all 0.3s ease;
    }

    [data-style="cyberpunk"] .logo-icon,
    [data-style="synthwave"] .logo-icon,
    [data-style="neonpink"] .logo-icon {
      animation: logoPulse 3s ease-in-out infinite;
    }

    @keyframes logoPulse {
      0%, 100% { box-shadow: var(--glow-primary); }
      50% { box-shadow: 0 0 30px var(--accent-secondary); }
    }

    h1 {
      font-family: var(--font-display);
      font-size: 2.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    [data-style="cyberpunk"] h1,
    [data-style="synthwave"] h1,
    [data-style="neonpink"] h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.8rem;
      font-weight: 900;
      letter-spacing: 4px;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
      -webkit-background-clip: text;
      background-clip: text;
      text-transform: uppercase;
    }

    [data-style="matrix"] h1,
    [data-style="hacker"] h1 {
      text-shadow: 0 0 10px var(--accent-primary);
    }

    [data-style="pixel"] h1 {
      font-size: 1.8rem;
      text-shadow: 4px 4px 0 var(--accent-secondary);
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      font-weight: 300;
      margin-top: 8px;
    }

    [data-style="cyberpunk"] .subtitle,
    [data-style="synthwave"] .subtitle,
    [data-style="neonpink"] .subtitle {
      font-size: 0.9rem;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    [data-style="pixel"] .subtitle {
      font-size: 0.6rem;
      letter-spacing: 1px;
    }

    .server-info {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .info-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      font-size: 0.85rem;
      color: var(--text-secondary);
      transition: all 0.2s ease;
    }

    .info-badge:hover {
      background: var(--bg-card-hover);
      border-color: var(--accent-primary);
    }

    [data-style="cyberpunk"] .info-badge,
    [data-style="synthwave"] .info-badge,
    [data-style="neonpink"] .info-badge {
      border-radius: var(--radius-sm);
      position: relative;
      overflow: hidden;
    }

    [data-style="cyberpunk"] .info-badge::before,
    [data-style="synthwave"] .info-badge::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s ease;
    }

    [data-style="cyberpunk"] .info-badge:hover::before {
      left: 100%;
    }

    .info-badge a {
      color: var(--accent-primary);
      text-decoration: none;
      transition: opacity 0.2s ease;
    }

    .info-badge a:hover {
      opacity: 0.8;
      text-shadow: 0 0 10px var(--accent-primary);
    }

    .info-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .info-dot.web {
      background: var(--accent-success);
      box-shadow: 0 0 8px var(--accent-success);
    }

    .info-dot.mcp {
      background: var(--accent-primary);
      box-shadow: 0 0 8px var(--accent-primary);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    [data-style="matrix"] .info-dot,
    [data-style="hacker"] .info-dot {
      border-radius: 0;
    }

    .control-panel {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control-row {
      display: flex;
      gap: 8px;
    }

    .control-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .control-btn:hover {
      background: var(--bg-card);
      border-color: var(--accent-primary);
    }

    .control-btn.active {
      background: var(--accent-primary);
      color: var(--bg-primary);
      border-color: var(--accent-primary);
    }

    [data-style="cyberpunk"] .control-btn.active,
    [data-style="synthwave"] .control-btn.active,
    [data-style="neonpink"] .control-btn.active {
      box-shadow: var(--glow-primary);
    }

    .style-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      margin-top: 8px;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 8px;
      display: none;
      max-height: 300px;
      overflow-y: auto;
      min-width: 200px;
      box-shadow: var(--shadow-lg);
    }

    .style-dropdown.show {
      display: block;
    }

    .style-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.8rem;
    }

    .style-option:hover {
      background: var(--bg-card-hover);
    }

    .style-option.active {
      background: var(--accent-primary);
      color: var(--bg-primary);
    }

    .style-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    .settings-card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    [data-style="cyberpunk"] .settings-card::before,
    [data-style="synthwave"] .settings-card::before,
    [data-style="neonpink"] .settings-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
    }

    .settings-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
    }

    .settings-header h2 {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .settings-icon {
      width: 32px;
      height: 32px;
      background: rgba(99, 102, 241, 0.15);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent-primary);
    }

    .settings-grid {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 16px;
      align-items: center;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-group label {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .input-wrapper {
      display: flex;
      gap: 8px;
    }

    input[type="text"] {
      flex: 1;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    input[type="text"].long-input {
      width: 100%;
    }

    input[type="password"] {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 12px 16px;
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }

    input[type="password"]:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .checkbox-wrapper:hover {
      background: var(--bg-card-hover);
    }

    .checkbox-wrapper input {
      width: 18px;
      height: 18px;
      accent-color: var(--accent-primary);
      cursor: pointer;
    }

    .checkbox-wrapper span {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 24px;
      border: none;
      border-radius: var(--radius-md);
      font-family: var(--font-display);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      color: white;
      box-shadow: var(--glow-primary);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--accent-success), var(--accent-secondary));
      color: white;
      box-shadow: var(--glow-success);
    }

    .btn-success:hover {
      transform: translateY(-2px);
    }

    .btn-accent {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
      color: white;
      box-shadow: 0 4px 16px rgba(6, 182, 212, 0.3);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      background: var(--bg-secondary);
      padding: 6px;
      border-radius: var(--radius-lg);
    }

    .tab {
      flex: 1;
      padding: 14px 20px;
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      color: var(--text-muted);
      font-family: var(--font-display);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab.active {
      background: var(--bg-card);
      color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .tab:hover:not(.active) {
      color: var(--text-secondary);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 20px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    [data-style="cyberpunk"] .card::before,
    [data-style="synthwave"] .card::before,
    [data-style="neonpink"] .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
    }

    .card:hover {
      border-color: var(--accent-primary);
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .card-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .card-icon.github { background: rgba(16, 185, 129, 0.15); }
    .card-icon.compress { background: rgba(99, 102, 241, 0.15); }
    .card-icon.extract { background: rgba(6, 182, 212, 0.15); }

    .card-title h3 {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .card-title p {
      font-size: 0.85rem;
      color: var(--text-muted);
      font-weight: 400;
    }

    .form-group {
      margin-bottom: 12px;
    }

    .form-group label {
      display: block;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .file-input-wrapper {
      display: flex;
      gap: 10px;
    }

    .file-input-wrapper input {
      flex: 1;
    }

    .file-input-wrapper .btn {
      white-space: nowrap;
    }

    .note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 8px;
      font-style: italic;
    }

    .btn-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 24px;
    }

    .btn-group .btn {
      width: 100%;
    }

    .status-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      padding: 12px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 100;
    }

    .status-text {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent-success);
      animation: pulse 2s infinite;
    }

    .status-spinner {
      display: none;
      width: 16px;
      height: 16px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent-primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .status-bar.loading .status-spinner {
      display: block;
    }

    .status-bar.loading .status-dot {
      display: none;
    }

    .toast {
      position: fixed;
      top: 24px;
      right: 24px;
      padding: 16px 24px;
      border-radius: var(--radius-md);
      color: white;
      font-weight: 500;
      z-index: 1000;
      animation: slideIn 0.3s ease;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .toast.success { background: linear-gradient(135deg, var(--accent-success), #059669); }
    .toast.error { background: linear-gradient(135deg, var(--accent-error), #dc2626); }
    .toast.warning { background: linear-gradient(135deg, var(--accent-warning), #d97706); }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .main-content {
      padding-bottom: 80px;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-box {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 32px;
      width: 100%;
      max-width: 600px;
      margin: 0 24px;
      box-shadow: var(--shadow-lg);
      transform: scale(0.9) translateY(20px);
      transition: all 0.3s ease;
      position: relative;
    }

    .modal-overlay.active .modal-box {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .modal-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-subtitle {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .modal-input {
      width: 100%;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 14px 18px;
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.95rem;
      transition: all 0.2s ease;
      margin-bottom: 20px;
    }

    .modal-input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .modal-actions .btn {
      padding: 12px 24px;
      min-width: 100px;
    }

    .log-panel {
      position: fixed;
      top: 0;
      right: 0;
      height: 100vh;
      z-index: 1500;
      display: flex;
    }

    .log-trigger {
      width: 6px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
      cursor: pointer;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.6;
    }

    .log-trigger:hover {
      width: 10px;
      opacity: 1;
    }

    .log-trigger-icon {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      color: white;
      font-size: 12px;
      font-weight: 500;
      letter-spacing: 2px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .log-trigger:hover .log-trigger-icon {
      opacity: 1;
    }

    .log-content {
      width: 0;
      height: 100%;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border-left: 1px solid var(--border-color);
      overflow: hidden;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
    }

    .log-panel:hover .log-content {
      width: 400px;
    }

    .log-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .log-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .log-header-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .log-clear-btn {
      padding: 8px 16px;
      font-size: 0.8rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .log-clear-btn:hover {
      background: var(--accent-error);
      border-color: var(--accent-error);
      color: white;
    }

    .log-list {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .log-list::-webkit-scrollbar {
      width: 6px;
    }

    .log-list::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    .log-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 16px;
      margin-bottom: 12px;
      animation: logSlideIn 0.3s ease;
    }

    @keyframes logSlideIn {
      from { opacity: 0; transform: translateX(20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .log-item-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .log-item-icon {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }

    .log-item-icon.clone { background: rgba(16, 185, 129, 0.15); }
    .log-item-icon.download { background: rgba(6, 182, 212, 0.15); }
    .log-item-icon.compress { background: rgba(99, 102, 241, 0.15); }
    .log-item-icon.extract { background: rgba(245, 158, 11, 0.15); }

    .log-item-type {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--text-primary);
    }

    .log-item-time {
      margin-left: auto;
      font-size: 0.75rem;
      color: var(--text-muted);
      font-family: var(--font-mono);
    }

    .log-item-message {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .log-item-path {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      padding: 10px 12px;
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--accent-secondary);
      word-break: break-all;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .log-item-path:hover {
      background: var(--bg-card);
      border-color: var(--accent-primary);
    }

    .log-item-path-icon {
      color: var(--text-muted);
      flex-shrink: 0;
    }

    .log-empty {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
    }

    .log-empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .log-empty-text {
      font-size: 0.9rem;
    }

    .proxy-section {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .proxy-section input {
      width: 100px !important;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="control-panel">
    <div class="control-row">
      <button class="control-btn" id="styleBtn" onclick="toggleStyleDropdown()">
        <span>ðŸŽ¨</span>
        <span id="styleLabel">Style</span>
      </button>
      <button class="control-btn" id="themeBtn" onclick="toggleTheme()">
        <span id="themeIcon">ðŸŒ™</span>
        <span id="themeText">Dark</span>
      </button>
    </div>
    <div class="style-dropdown" id="styleDropdown">
      <div class="style-option" data-style="default" onclick="setStyle('default')">
        <div class="style-color" style="background: linear-gradient(135deg, #6366f1, #818cf8)"></div>
        <span>Default</span>
      </div>
      <div class="style-option" data-style="cyberpunk" onclick="setStyle('cyberpunk')">
        <div class="style-color" style="background: linear-gradient(135deg, #00fff5, #ff00ff)"></div>
        <span>Cyberpunk</span>
      </div>
      <div class="style-option" data-style="retro" onclick="setStyle('retro')">
        <div class="style-color" style="background: linear-gradient(135deg, #58a6ff, #7ee787)"></div>
        <span>Retro Terminal</span>
      </div>
      <div class="style-option" data-style="nord" onclick="setStyle('nord')">
        <div class="style-color" style="background: linear-gradient(135deg, #88c0d0, #81a1c1)"></div>
        <span>Nord</span>
      </div>
      <div class="style-option" data-style="dracula" onclick="setStyle('dracula')">
        <div class="style-color" style="background: linear-gradient(135deg, #bd93f9, #ff79c6)"></div>
        <span>Dracula</span>
      </div>
      <div class="style-option" data-style="synthwave" onclick="setStyle('synthwave')">
        <div class="style-color" style="background: linear-gradient(135deg, #ff2a6d, #05d9e8)"></div>
        <span>Synthwave</span>
      </div>
      <div class="style-option" data-style="matrix" onclick="setStyle('matrix')">
        <div class="style-color" style="background: #00ff00"></div>
        <span>Matrix</span>
      </div>
      <div class="style-option" data-style="sunset" onclick="setStyle('sunset')">
        <div class="style-color" style="background: linear-gradient(135deg, #ff6b6b, #ffa07a)"></div>
        <span>Sunset</span>
      </div>
      <div class="style-option" data-style="ocean" onclick="setStyle('ocean')">
        <div class="style-color" style="background: linear-gradient(135deg, #00d4ff, #0099cc)"></div>
        <span>Ocean</span>
      </div>
      <div class="style-option" data-style="forest" onclick="setStyle('forest')">
        <div class="style-color" style="background: linear-gradient(135deg, #4ade80, #22c55e)"></div>
        <span>Forest</span>
      </div>
      <div class="style-option" data-style="candy" onclick="setStyle('candy')">
        <div class="style-color" style="background: linear-gradient(135deg, #c084fc, #f472b6)"></div>
        <span>Candy</span>
      </div>
      <div class="style-option" data-style="hacker" onclick="setStyle('hacker')">
        <div class="style-color" style="background: #00ff41"></div>
        <span>Hacker</span>
      </div>
      <div class="style-option" data-style="pixel" onclick="setStyle('pixel')">
        <div class="style-color" style="background: linear-gradient(135deg, #f4f4f4, #94b0c2)"></div>
        <span>Pixel</span>
      </div>
      <div class="style-option" data-style="neonpink" onclick="setStyle('neonpink')">
        <div class="style-color" style="background: linear-gradient(135deg, #ff0080, #ff00ff)"></div>
        <span>Neon Pink</span>
      </div>
    </div>
  </div>

  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">âš¡</div>
        <h1>ShareTools</h1>
      </div>
      <p class="subtitle">Developer Utilities Suite with MCP Integration</p>
      <div class="server-info">
        <div class="info-badge">
          <span class="info-dot web"></span>
          <a href="http://localhost:3000" target="_self"><span>Web API</span></a>
        </div>
        <div class="info-badge">
          <span class="info-dot mcp"></span>
          <a href="http://localhost:3000/mcp/streamable-http" target="_blank"><span>MCP HTTP</span></a>
        </div>
      </div>
    </header>

    <div class="settings-card">
      <div class="settings-header">
        <div class="settings-icon">âš™</div>
        <h2>Settings</h2>
      </div>
      <div class="settings-grid">
        <div class="input-group">
          <label>Parent Folder</label>
          <div class="input-wrapper">
            <input type="text" id="parentFolder" placeholder="repo-files">
            <button class="btn btn-secondary" onclick="browseFolder('parentFolder')">Browse</button>
          </div>
        </div>
      </div>
      <div class="input-group" style="margin-top: 12px;">
        <label>Clone Proxy (Home only)</label>
        <div class="proxy-section" id="proxySection">
          <label class="checkbox-wrapper" style="background: transparent; padding: 6px 10px;">
            <input type="checkbox" id="proxyEnabled">
            <span>Enable</span>
          </label>
          <input type="text" id="proxyAddress" placeholder="127.0.0.1" style="width: 100px; text-align: center;">
          <input type="text" id="proxyPort" placeholder="Port" style="width: 60px; text-align: center;">
          <input type="text" id="proxyUser" placeholder="Username" style="width: 100px;">
          <input type="password" id="proxyPass" placeholder="Password" style="width: 100px;">
        </div>
      </div>
      <div class="input-group" style="margin-top: 12px;">
        <label>Download Proxy (Company only)</label>
        <div class="proxy-section">
          <label class="checkbox-wrapper" style="background: transparent; padding: 6px 10px;">
            <input type="checkbox" id="downloadProxyEnabled">
            <span>Enable</span>
          </label>
          <input type="text" id="downloadProxyAddress" placeholder="127.0.0.1" style="width: 100px; text-align: center;">
          <input type="text" id="downloadProxyPort" placeholder="Port" style="width: 60px; text-align: center;">
          <input type="text" id="downloadProxyUser" placeholder="Username" style="width: 100px;">
          <input type="password" id="downloadProxyPass" placeholder="Password" style="width: 100px;">
        </div>
      </div>
      <div style="margin-top: 16px; text-align: right;">
        <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
      </div>
    </div>

    <div class="tabs">
      <button class="tab" data-tab="github">GitHub Clone</button>
      <button class="tab" data-tab="download">Download</button>
      <button class="tab" data-tab="compress">Compress</button>
      <button class="tab" data-tab="extract">Extract</button>
    </div>

    <div class="main-content">
      <div class="tab-content" id="github-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon github">ðŸ“¦</div>
            <div>
              <h3>Clone Repository</h3>
              <p>Clone a GitHub repository to your local folder</p>
            </div>
          </div>
          <div class="form-group">
            <label>Repository URL</label>
            <input type="text" id="githubUrl" class="long-input" placeholder="https://github.com/username/repository.git">
            <p class="note">Example: https://github.com/facebook/react.git</p>
          </div>
          <button class="btn btn-success" style="width: 100%;" onclick="cloneRepo()" id="cloneBtn">
            Clone Repository
          </button>
        </div>
      </div>

      <div class="tab-content" id="download-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon github">ðŸ“¥</div>
            <div>
              <h3>Download File</h3>
              <p>Download a single file from GitHub</p>
            </div>
          </div>
          <div class="form-group">
            <label>File URL</label>
            <input type="text" id="downloadUrl" class="long-input" placeholder="https://github.com/username/repo/blob/main/file.txt">
            <p class="note">Will be converted to raw URL automatically</p>
          </div>
          <button class="btn btn-success" style="width: 100%;" onclick="downloadFile()" id="downloadBtn">
            Download File
          </button>
        </div>
      </div>

      <div class="tab-content" id="compress-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon compress">ðŸ“</div>
            <div>
              <h3>Compress Folder</h3>
              <p>Package folder to portable format</p>
            </div>
          </div>
          <div class="form-group">
            <label>Source Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="compressSource" placeholder="Select folder to compress">
              <button class="btn btn-secondary" onclick="browseFolder('compressSource')">Browse</button>
            </div>
          </div>
          <div class="form-group">
            <label>Output Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="compressOutput" placeholder="Select output folder">
              <button class="btn btn-secondary" onclick="browseFolder('compressOutput')">Browse</button>
            </div>
            <p class="note">Note: Excludes .git, node_modules, target, build, __pycache__, etc.</p>
          </div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="compressZipBase64()" id="zipBtn">
              ZIP + Base64
            </button>
            <button class="btn btn-accent" onclick="compressTxt()" id="txtBtn">
              Merge to TXT
            </button>
          </div>
        </div>
      </div>

      <div class="tab-content" id="extract-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon extract">ðŸ“¤</div>
            <div>
              <h3>Extract Files</h3>
              <p>Extract files from archive</p>
            </div>
          </div>
          <div class="form-group">
            <label>Input File</label>
            <div class="file-input-wrapper">
              <input type="text" id="extractInput" placeholder="Select file to extract">
              <button class="btn btn-secondary" onclick="browseFile('extractInput')">Browse</button>
            </div>
          </div>
          <div class="form-group">
            <label>Output Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="extractOutput" placeholder="Select output folder">
              <button class="btn btn-secondary" onclick="browseFolder('extractOutput')">Browse</button>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="extractZipBase64()" id="extractZipBtn">
              Extract ZIP+Base64
            </button>
            <button class="btn btn-accent" onclick="extractTxt()" id="extractTxtBtn">
              Extract TXT
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="status-bar" id="statusBar">
    <div class="status-text">
      <div class="status-spinner"></div>
      <div class="status-dot"></div>
      <span id="statusText">Ready</span>
    </div>
    <div style="display: flex; align-items: center; gap: 20px;">
      <div style="display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-muted);">
        <span class="mcp-status-dot" id="mcpStatusDot" style="width: 8px; height: 8px; border-radius: 50%; background: var(--accent-success); animation: pulse 2s infinite;"></span>
        <span id="mcpStatusText">MCP HTTP: Active</span>
      </div>
      <div style="font-size: 0.8rem; color: var(--text-muted);">
        Folders: <span id="folderInfo">-</span>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="pathModal" onclick="if(event.target === this) closeModal()">
    <div class="modal-box" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div class="modal-icon" id="modalIcon">ðŸ“</div>
        <div>
          <div class="modal-title" id="modalTitle">Select Folder</div>
          <div class="modal-subtitle" id="modalSubtitle">Please enter the path</div>
        </div>
      </div>
      <input type="text" class="modal-input" id="modalInput" placeholder="Enter path...">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="confirmModal()">Confirm</button>
      </div>
    </div>
  </div>

  <div class="log-panel" id="logPanel">
    <div class="log-trigger">
      <span class="log-trigger-icon">LOGS</span>
    </div>
    <div class="log-content">
      <div class="log-header">
        <h3>
          <div class="log-header-icon">ðŸ“‹</div>
          Operation Logs
        </h3>
        <button class="log-clear-btn" onclick="clearLogs()">Clear All</button>
      </div>
      <div class="log-list" id="logList">
        <div class="log-empty" id="logEmpty">
          <div class="log-empty-icon">ðŸ“­</div>
          <div class="log-empty-text">No operation records</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = '';
    let config = {};

    function getInputValue(inputId) {
      const element = document.getElementById(inputId);
      if (!element) return '';
      let value = element.value.trim();
      if ((value.startsWith('"') && value.endsWith('"')) ||
          (value.startsWith("'") && value.endsWith("'"))) {
        value = value.slice(1, -1);
      }
      return value;
    }

    const LOG_STORAGE_KEY = 'sharetools_logs';
    const MAX_LOGS = 100;

    const LOG_TYPES = {
      clone: { icon: 'ðŸ“¦', label: 'GitHub Clone', cssClass: 'clone' },
      download: { icon: 'ðŸ“¥', label: 'File Download', cssClass: 'download' },
      'compress-zip': { icon: 'ðŸ—œï¸', label: 'ZIP+Base64 Compress', cssClass: 'compress' },
      'compress-txt': { icon: 'ðŸ“„', label: 'TXT Merge', cssClass: 'compress' },
      'extract-zip': { icon: 'ðŸ“¤', label: 'ZIP+Base64 Extract', cssClass: 'extract' },
      'extract-txt': { icon: 'ðŸ“', label: 'TXT Extract', cssClass: 'extract' }
    };

    function getLogs() {
      try {
        return JSON.parse(localStorage.getItem(LOG_STORAGE_KEY) || '[]');
      } catch {
        return [];
      }
    }

    function saveLogs(logs) {
      localStorage.setItem(LOG_STORAGE_KEY, JSON.stringify(logs));
    }

    function addLog(type, message, path) {
      const logs = getLogs();
      const logType = LOG_TYPES[type] || { icon: 'ðŸ“Œ', label: 'Operation', cssClass: '' };

      const newLog = {
        id: Date.now(),
        type: type,
        icon: logType.icon,
        label: logType.label,
        cssClass: logType.cssClass,
        message: message,
        path: path || '',
        time: new Date().toLocaleString('zh-CN', {
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        })
      };

      logs.unshift(newLog);
      if (logs.length > MAX_LOGS) {
        logs.pop();
      }
      saveLogs(logs);
      renderLogs();
    }

    function clearLogs() {
      localStorage.removeItem(LOG_STORAGE_KEY);
      renderLogs();
    }

    function copyPath(path) {
      navigator.clipboard.writeText(path).then(() => {
        showToast('Path copied to clipboard');
      }).catch(() => {
        const textarea = document.createElement('textarea');
        textarea.value = path;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('Path copied to clipboard');
      });
    }

    function renderLogs() {
      const logs = getLogs();
      const logList = document.getElementById('logList');

      if (logs.length === 0) {
        logList.innerHTML = `
          <div class="log-empty" id="logEmpty">
            <div class="log-empty-icon">ðŸ“­</div>
            <div class="log-empty-text">No operation records</div>
          </div>
        `;
        return;
      }

      logList.innerHTML = logs.map(log => `
        <div class="log-item">
          <div class="log-item-header">
            <div class="log-item-icon ${log.cssClass}">${log.icon}</div>
            <span class="log-item-type">${log.label}</span>
            <span class="log-item-time">${log.time}</span>
          </div>
          <div class="log-item-message">${log.message}</div>
          ${log.path ? `
            <div class="log-item-path" onclick="copyPath('${log.path.replace(/\\/g, '\\\\')}')" title="Click to copy path">
              <span class="log-item-path-icon">ðŸ“‹</span>
              <span>${log.path}</span>
            </div>
          ` : ''}
        </div>
      `).join('');
    }

    renderLogs();

    function getStyle() {
      return localStorage.getItem('uiStyle') || 'default';
    }

    function setStyle(style) {
      document.documentElement.setAttribute('data-style', style);
      localStorage.setItem('uiStyle', style);
      
      document.querySelectorAll('.style-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.style === style);
      });
      
      document.getElementById('styleDropdown').classList.remove('show');
    }

    function toggleStyleDropdown() {
      document.getElementById('styleDropdown').classList.toggle('show');
    }

    document.addEventListener('click', function(e) {
      const dropdown = document.getElementById('styleDropdown');
      const btn = document.getElementById('styleBtn');
      if (!dropdown.contains(e.target) && !btn.contains(e.target)) {
        dropdown.classList.remove('show');
      }
    });

    function getTheme() {
      return localStorage.getItem('theme') || 'dark';
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      
      const themeIcon = document.getElementById('themeIcon');
      const themeText = document.getElementById('themeText');
      
      if (theme === 'dark') {
        themeIcon.textContent = 'ðŸŒ™';
        themeText.textContent = 'Dark';
      } else {
        themeIcon.textContent = 'â˜€ï¸';
        themeText.textContent = 'Light';
      }
    }

    function toggleTheme() {
      const current = getTheme();
      setTheme(current === 'dark' ? 'light' : 'dark');
    }

    setStyle(getStyle());
    setTheme(getTheme());

    async function api(endpoint, options = {}) {
      const response = await fetch(`${API_BASE}${endpoint}`, {
        ...options,
        headers: {
          'Content-Type': 'application/json',
          ...options.headers
        }
      });
      return response.json();
    }

    async function checkMCPStatus() {
      try {
        const response = await fetch('http://localhost:3000/mcp/streamable-http', {
          method: 'GET'
        });
        
        if (response.status === 406 || response.ok) {
          updateMCPStatus(true);
        } else {
          updateMCPStatus(false);
        }
      } catch (e) {
        updateMCPStatus(false);
      }
    }

    function updateMCPStatus(isActive) {
      const dot = document.getElementById('mcpStatusDot');
      const text = document.getElementById('mcpStatusText');
      
      if (isActive) {
        dot.style.background = 'var(--accent-success)';
        text.textContent = 'MCP HTTP: Active';
      } else {
        dot.style.background = 'var(--accent-error)';
        text.textContent = 'MCP HTTP: Inactive';
      }
    }

    async function init() {
      const serverConfig = await api('/api/config');
      
      const systemInfo = await api('/api/system-info');
      const isNumericUsername = systemInfo.isNumericUsername;
      
      config = {
        parent_folder: serverConfig.parent_folder || 'repo-files',
        proxy_enabled: serverConfig.proxy_enabled || false,
        proxy_address: serverConfig.proxy_address || '127.0.0.1',
        proxy_port: serverConfig.proxy_port || 10808,
        proxy_user: serverConfig.proxy_user || '',
        proxy_pass: serverConfig.proxy_pass || '',
        download_proxy_enabled: serverConfig.download_proxy_enabled || false,
        download_proxy_address: serverConfig.download_proxy_address || '127.0.0.1',
        download_proxy_port: serverConfig.download_proxy_port || 10808,
        download_proxy_user: serverConfig.download_proxy_user || '',
        download_proxy_pass: serverConfig.download_proxy_pass || ''
      };
      
      document.getElementById('parentFolder').value = config.parent_folder;
      document.getElementById('proxyEnabled').checked = config.proxy_enabled;
      document.getElementById('proxyAddress').value = config.proxy_address;
      document.getElementById('proxyPort').value = config.proxy_port;
      document.getElementById('proxyUser').value = config.proxy_user;
      document.getElementById('proxyPass').value = config.proxy_pass;
      document.getElementById('downloadProxyEnabled').checked = config.download_proxy_enabled;
      document.getElementById('downloadProxyAddress').value = config.download_proxy_address;
      document.getElementById('downloadProxyPort').value = config.download_proxy_port;
      document.getElementById('downloadProxyUser').value = config.download_proxy_user;
      document.getElementById('downloadProxyPass').value = config.download_proxy_pass;
      
      const folders = await api(`/api/folders?parent=${encodeURIComponent(config.parent_folder)}`);
      document.getElementById('folderInfo').textContent = 
        `github: ${folders.github}, compress: ${folders.compress}, extract: ${folders.extract}, download: ${folders.download}`;
      document.getElementById('compressOutput').value = folders.compress;
      document.getElementById('extractOutput').value = folders.extract;
      
      updateTabsVisibility(isNumericUsername);
      
      checkMCPStatus();
      setInterval(checkMCPStatus, 30000);
    }

    function updateTabsVisibility(isNumericUsername) {
      const githubTab = document.querySelector('[data-tab="github"]');
      const proxySection = document.getElementById('proxySection');
      
      if (githubTab) {
        if (isNumericUsername) {
          githubTab.style.display = 'none';
          document.getElementById('github-tab').style.display = 'none';
          if (proxySection) proxySection.style.display = 'none';
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.querySelector('[data-tab="download"]').classList.add('active');
          document.getElementById('download-tab').classList.add('active');
        } else {
          githubTab.style.display = '';
          document.getElementById('github-tab').style.display = '';
          if (proxySection) proxySection.style.display = 'flex';
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.querySelector('[data-tab="github"]').classList.add('active');
          document.getElementById('github-tab').classList.add('active');
        }
      }
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
      });
    });

    function setStatus(text, loading = false) {
      const bar = document.getElementById('statusBar');
      document.getElementById('statusText').textContent = text;
      bar.classList.toggle('loading', loading);
    }

    function showToast(message, type = 'success') {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.remove(), 4000);
    }

    let currentModalCallback = null;
    let currentInputId = null;

    function openModal(options) {
      const modal = document.getElementById('pathModal');
      const icon = document.getElementById('modalIcon');
      const title = document.getElementById('modalTitle');
      const subtitle = document.getElementById('modalSubtitle');
      const input = document.getElementById('modalInput');

      icon.textContent = options.icon || 'ðŸ“';
      title.textContent = options.title || 'Select Path';
      subtitle.textContent = options.subtitle || 'Please enter path';
      input.placeholder = options.placeholder || 'Enter path...';
      input.value = options.defaultValue || '';

      currentModalCallback = options.onConfirm;
      currentInputId = options.inputId;
      input.focus();

      modal.classList.add('active');
      input.select();

      input.onkeydown = (e) => {
        if (e.key === 'Enter') {
          confirmModal();
        } else if (e.key === 'Escape') {
          closeModal();
        }
      };
    }

    function closeModal() {
      const modal = document.getElementById('pathModal');
      modal.classList.remove('active');
      currentModalCallback = null;
      currentInputId = null;
    }

    function confirmModal() {
      const input = document.getElementById('modalInput');
      let value = input.value.trim();

      if ((value.startsWith('"') && value.endsWith('"')) ||
          (value.startsWith("'") && value.endsWith("'"))) {
        value = value.slice(1, -1);
      }

      if (value && currentInputId) {
        document.getElementById(currentInputId).value = value;
      }

      if (currentModalCallback) {
        currentModalCallback(value);
      }

      closeModal();
    }

    async function browseFolder(inputId) {
      const input = document.getElementById(inputId);
      openModal({
        icon: 'ðŸ“',
        title: 'Select Folder',
        subtitle: 'Please enter the full folder path',
        placeholder: 'e.g.: C:\\Users\\Username\\Documents',
        defaultValue: input.value,
        inputId: inputId
      });
    }

    async function browseFile(inputId) {
      const input = document.getElementById(inputId);
      openModal({
        icon: 'ðŸ“„',
        title: 'Select File',
        subtitle: 'Please enter the full file path',
        placeholder: 'e.g.: C:\\Users\\Username\\file.txt',
        defaultValue: input.value,
        inputId: inputId
      });
    }

    async function saveSettings() {
      const parentFolder = getInputValue('parentFolder');
      const proxyEnabled = document.getElementById('proxyEnabled').checked;
      const proxyAddress = getInputValue('proxyAddress') || '127.0.0.1';
      const proxyPort = parseInt(getInputValue('proxyPort')) || 10808;
      const proxyUser = getInputValue('proxyUser');
      const proxyPass = getInputValue('proxyPass');
      const downloadProxyEnabled = document.getElementById('downloadProxyEnabled').checked;
      const downloadProxyAddress = getInputValue('downloadProxyAddress') || '127.0.0.1';
      const downloadProxyPort = parseInt(getInputValue('downloadProxyPort')) || 10808;
      const downloadProxyUser = getInputValue('downloadProxyUser');
      const downloadProxyPass = getInputValue('downloadProxyPass');
      
      const settings = {
        parent_folder: parentFolder,
        proxy_enabled: proxyEnabled,
        proxy_address: proxyAddress,
        proxy_port: proxyPort,
        proxy_user: proxyUser,
        proxy_pass: proxyPass,
        download_proxy_enabled: downloadProxyEnabled,
        download_proxy_address: downloadProxyAddress,
        download_proxy_port: downloadProxyPort,
        download_proxy_user: downloadProxyUser,
        download_proxy_pass: downloadProxyPass
      };
      
      try {
        await api('/api/config', {
          method: 'POST',
          body: JSON.stringify(settings)
        });
        
        config = settings;
        
        const folders = await api(`/api/folders?parent=${encodeURIComponent(config.parent_folder)}`);
        document.getElementById('folderInfo').textContent = 
          `github: ${folders.github}, compress: ${folders.compress}, extract: ${folders.extract}, download: ${folders.download}`;
        document.getElementById('compressOutput').value = folders.compress;
        document.getElementById('extractOutput').value = folders.extract;
        
        showToast('Settings saved successfully!');
      } catch (error) {
        showToast('Failed to save settings: ' + error.message, 'error');
      }
    }
    
    async function cloneRepo() {
      const url = document.getElementById('githubUrl').value.trim();
      if (!url) {
        showToast('Please enter a GitHub repository URL!', 'error');
        return;
      }
      
      setStatus('Cloning repository...', true);
      const btn = document.getElementById('cloneBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Cloning...';
      
      try {
        const result = await api('/api/github/clone', {
          method: 'POST',
          body: JSON.stringify({ url })
        });
        
        if (result.success) {
          showToast(`Repository cloned to: ${result.path}`);
          const repoName = url.replace(/\.git$/, '').split('/').pop();
          addLog('clone', `Clone repository ${repoName} to ${result.path} successfully`, result.path);
        } else {
          if (result.proxyStatus === 'available_not_used') {
            showToast(result.error + ' You can enable it in Settings.', 'warning');
          } else if (result.proxyStatus === 'not_open') {
            showToast(result.error, 'error');
          } else {
            showToast(result.error || 'Clone failed', 'error');
          }
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    async function compressZipBase64() {
      const sourceFolder = getInputValue('compressSource');
      const outputFolder = getInputValue('compressOutput');
      
      if (!sourceFolder) {
        showToast('Please select a source folder!', 'error');
        return;
      }
      
      setStatus('Creating ZIP with exclusions...', true);
      const btn = document.getElementById('zipBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Compressing...';
      
      try {
        const result = await api('/api/compress/zip-base64', {
          method: 'POST',
          body: JSON.stringify({ sourceFolder, outputFolder })
        });
        
        if (result.success) {
          showToast(`Saved to: ${result.outputPath}`);
          const folderName = sourceFolder.split(/[/\\]/).pop();
          addLog('compress-zip', `Compress ${folderName} to ${result.outputPath} successfully`, result.outputPath);
        } else {
          showToast(result.error || 'Compression failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    async function compressTxt() {
      const sourceFolder = getInputValue('compressSource');
      const outputFolder = getInputValue('compressOutput');
      
      if (!sourceFolder) {
        showToast('Please select a source folder!', 'error');
        return;
      }
      
      setStatus('Merging files to TXT...', true);
      const btn = document.getElementById('txtBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Merging...';
      
      try {
        const result = await api('/api/compress/txt', {
          method: 'POST',
          body: JSON.stringify({ sourceFolder, outputFolder })
        });
        
        if (result.success) {
          showToast(`Files merged: ${result.fileCount}, Skipped: ${result.skipCount}\nSaved to: ${result.outputPath}`);
          const folderName = sourceFolder.split(/[/\\]/).pop();
          addLog('compress-txt', `Merge ${result.fileCount} files (${folderName}) to ${result.outputPath} successfully`, result.outputPath);
        } else {
          showToast(result.error || 'Compression failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    async function extractZipBase64() {
      const inputFile = getInputValue('extractInput');
      const outputFolder = getInputValue('extractOutput');
      
      if (!inputFile) {
        showToast('Please select an input file!', 'error');
        return;
      }
      
      setStatus('Extracting ZIP+Base64...', true);
      const btn = document.getElementById('extractZipBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Extracting...';
      
      try {
        const result = await api('/api/extract/zip-base64', {
          method: 'POST',
          body: JSON.stringify({ inputFile, outputFolder })
        });
        
        if (result.success) {
          showToast(`Extracted to: ${result.outputPath}`);
          const fileName = inputFile.split(/[/\\]/).pop();
          addLog('extract-zip', `Extracted ${fileName} successfully`, result.outputPath);
        } else {
          showToast(result.error || 'Extraction failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    async function extractTxt() {
      const inputFile = getInputValue('extractInput');
      const outputFolder = getInputValue('extractOutput');
      
      if (!inputFile) {
        showToast('Please select an input file!', 'error');
        return;
      }
      
      setStatus('Extracting TXT...', true);
      const btn = document.getElementById('extractTxtBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Extracting...';
      
      try {
        const result = await api('/api/extract/txt', {
          method: 'POST',
          body: JSON.stringify({ inputFile, outputFolder })
        });
        
        if (result.success) {
          showToast(`Extracted ${result.fileCount} files to: ${result.outputPath}`);
          const fileName = inputFile.split(/[/\\]/).pop();
          addLog('extract-txt', `Extracted ${result.fileCount} files (${fileName})`, result.outputPath);
        } else {
          showToast(result.error || 'Extraction failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    async function downloadFile() {
      const url = getInputValue('downloadUrl');
      if (!url) {
        showToast('Please enter a GitHub file URL!', 'error');
        return;
      }
      
      setStatus('Downloading file...', true);
      const btn = document.getElementById('downloadBtn');
      const originalText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Downloading...';
      
      try {
        const result = await api('/api/github/download-file', {
          method: 'POST',
          body: JSON.stringify({ url })
        });
        
        if (result.success) {
          showToast(`File downloaded to: ${result.path}`);
          const fileName = result.path.split(/[/\\]/).pop();
          addLog('download', `Downloaded file ${fileName} successfully`, result.path);
        } else {
          showToast(result.error || 'Download failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      btn.disabled = false;
      btn.textContent = originalText;
    }

    init();
  </script>
</body>
</html>

===END===

===FILE:README.md===
# ShareTools

A comprehensive developer utilities suite with Web UI and MCP (Model Context Protocol) integration for AI-powered workflows.

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.8%2B-blue?style=flat-square" alt="Python">
  <img src="https://img.shields.io/badge/FastAPI-0.115%2B-green?style=flat-square" alt="FastAPI">
  <img src="https://img.shields.io/badge/FastMCP-2.0%2B-orange?style=flat-square" alt="FastMCP">
  <img src="https://img.shields.io/badge/License-MIT-blue?style=flat-square" alt="License">
</p>

---

## âœ¨ Features

### GitHub Integration
- **Repository Clone** - Clone any GitHub repository with proxy support
- **File Download** - Download single files directly from GitHub

### Compression Tools
- **ZIP + Base64** - Compress folders to ZIP and encode as Base64 text
- **Merge to TXT** - Merge all files into a single structured TXT file

### Extraction Tools
- **Extract ZIP+Base64** - Decode Base64 and extract ZIP archives
- **Extract from TXT** - Restore original file structure from merged TXT

### File Management
- **Browse Folders** - Navigate and list directory contents
- **Browse Files** - View file contents with optional filtering

### Configuration
- **Proxy Support** - Separate proxy settings for Git and downloads
- **Custom Folders** - Configure parent directory for all operations

---

## ðŸš€ Quick Start

```bash
# Install dependencies
pip install -r requirements.txt

# Start server (Web UI + MCP HTTP)
python server.py
```

The server will automatically open your browser to http://localhost:3000/ (Web UI) when it starts up.

---

## ðŸ“– Architecture

```
PublicDocuments/
â”œâ”€â”€ core.py              # ShareTools Core API (business logic)
â”œâ”€â”€ server.py            # Web Server entry point (FastAPI) with auto browser open feature
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html       # Web UI
â”œâ”€â”€ share-tools-skills/     # Claude/Trae Skill
â”‚   â”œâ”€â”€ SKILL.md         # Skill definition
â”‚   â””â”€â”€ scripts/         # Skill scripts (use core.py)
â”œâ”€â”€ config.json          # Runtime configuration
â”œâ”€â”€ requirements.txt     # Python dependencies
    â””â”€â”€ ...
```

### Module Design

| File | Description |
|------|-------------|
| `core.py` | Contains all business logic - reusable across projects |
| `server.py` | Web server + MCP protocol handlers - depends on core.py |

### ShareTools API Class

```python
from core import ShareToolsAPI

api = ShareToolsAPI()
```

---

## ðŸ”Œ Running Modes

| Command | Description | Ports | Browser Auto-Open |
|---------|-------------|-------|-------------------|
| `python server.py` | Web API + MCP HTTP (default) | 3000 | Yes, opens API docs at http://localhost:3000/docs |

---

## ðŸ¤– MCP Integration

### Available Tools (ShareTools Prefix)

All MCP tools have the `sharetools_` prefix for easy AI recognition:

| Tool | Description | Parameters |
|------|-------------|------------|
| `sharetools_github_clone` | Clone a GitHub repository | `url` |
| `sharetools_github_download` | Download a file from GitHub | `url` |
| `sharetools_compress_zip` | Compress folder to Base64 ZIP | `source_folder`, `output_folder?` |
| `sharetools_compress_txt` | Merge folder to TXT | `source_folder`, `output_folder?` |
| `sharetools_extract_zip` | Extract Base64 ZIP | `input_file`, `output_folder?` |
| `sharetools_extract_txt` | Extract from merged TXT | `input_file`, `output_folder?` |
| `sharetools_get_config` | Get current configuration | - |
| `sharetools_set_config` | Set configuration | `parent_folder`, `proxy_*`, etc. |
| `sharetools_browse_folder` | Browse folder contents | `path?` |
| `sharetools_browse_file` | Browse file or folder | `path`, `filter?` |
| `sharetools_get_folders` | Get configured folder paths | - |

### MCP Configuration

**For Claude/Trae (Stdio):**
```json
{
  "mcpServers": {
    "command": "python",
    "args": ["server.py", "--mcp-stdio"]
    }
}
```

**For Claude/Trae (HTTP):**
```json
{
  "mcpServers": {
    "url": "http://localhost:3000/mcp/streamable-http"
    }
}
```

---

## ðŸ› ï¸ API Usage (core.py)

Copy `core.py` to your project for direct API access:

```python
import asyncio
from core import api

# Clone repository
result = asyncio.run(api.github_clone('https://github.com/owner/repo'))

# Download file
result = asyncio.run(api.github_download('https://github.com/owner/repo/blob/main/file.txt'))

# Compress folder
result = asyncio.run(api.compress_zip('C:/path/to/folder'))

# Extract files
result = asyncio.run(api.extract_zip('C:/path/to/file.txt'))

# Get configuration
config = api.get_config()

# Set configuration
api.set_config({'parent_folder': 'my-files'})

# Browse folders
result = asyncio.run(api.browse_folder('C:/path'))

# Browse files
result = asyncio.run(api.browse_file('C:/path/to/file.txt'))
```

---

## ðŸŒ Web API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/config` | Get configuration |
| POST | `/api/config` | Set configuration |
| GET | `/api/folders` | Get folder paths |
| GET | `/api/system-info` | Get system information |
| POST | `/api/github/clone` | Clone repository |
| POST | `/api/github/download-file` | Download file |
| POST | `/api/compress/zip-base64` | Compress to ZIP+Base64 |
| POST | `/api/compress/txt` | Merge to TXT |
| POST | `/api/extract/zip-base64` | Extract ZIP+Base64 |
| POST | `/api/extract/txt` | Extract from TXT |
| GET | `/api/browse/folder` | Browse folder |
| GET | `/api/browse/file` | Browse file/folder |

---

## ðŸŽ“ Skill Usage

The `share-tools-skills` folder contains Python scripts that wrap `core.py`:

```bash
cd share-tools-skills/scripts

# Clone repository
python github_clone.py https://github.com/facebook/react

# Compress folder
python compress_zip.py "C:\Projects\myapp"

# Get configuration
python get_config.py
```

See [SKILL.md](share-tools-skills/SKILL.md) for detailed documentation.

---

## âš™ï¸ Configuration

### Default Settings

| Setting | Description | Default |
|---------|-------------|---------|
| `parent_folder` | Base folder for all operations | `repo-files` |
| `proxy_enabled` | Enable proxy for git clone | `false` |
| `proxy_address` | Proxy server address | `127.0.0.1` |
| `proxy_port` | Proxy server port | `10808` |
| `download_proxy_enabled` | Enable proxy for downloads | `false` |
| `download_proxy_address` | Download proxy address | `127.0.0.1` |
| `download_proxy_port` | Download proxy port | `10808` |

### Default Folder Structure

```
repo-files/
â”œâ”€â”€ github/     # Git clone destinations
â”œâ”€â”€ compress/   # Compressed output
â”œâ”€â”€ extract/    # Extracted files
â””â”€â”€ download/   # Downloaded files
```

---

## ðŸ“¦ Dependencies

```
fastapi>=0.115.0
uvicorn[standard]>=0.32.0
fastmcp>=2.0.0
pydantic>=2.10.0
```

---

## ðŸ“ License

MIT License - feel free to use in your projects.

---

## ðŸ”— References

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [FastMCP Documentation](https://fastmcp.wiki/)
- [MCP Protocol](https://modelcontextprotocol.io/)

===END===

===FILE:config.json===
{
  "parent_folder": "C:\\Users\\Steph\\Desktop\\PublicDocuments\\repo-files",
  "proxy_enabled": true,
  "proxy_address": "127.0.0.1",
  "proxy_port": 10808,
  "proxy_user": "",
  "proxy_pass": "",
  "download_proxy_enabled": true,
  "download_proxy_address": "127.0.0.1",
  "download_proxy_port": 10808,
  "download_proxy_user": "",
  "download_proxy_pass": ""
}
===END===

===FILE:core.py===
"""
ShareTools Core Module
Provides core functionality for GitHub operations, compression, and extraction.
"""

import os
import json
import base64
import shutil
import subprocess
import tempfile
import re
from pathlib import Path
from typing import Optional, Dict, Any, List, Tuple
from dataclasses import dataclass, asdict
from datetime import datetime

DEFAULT_PARENT = "repo-files"

EXCLUDE_PATTERNS = [
    ".git", ".svn", ".hg", ".gitignore", ".gitattributes",
    "node_modules", "bower_components", "vendor",
    "target", "build", "dist", "out",
    "__pycache__", ".pytest_cache", ".mypy_cache", ".tox",
    "venv", ".venv", "env", ".env",
    "bin", "obj", "packages",
    "*.pyc", "*.pyo", "*.class", "*.o", "*.so", "*.dll", "*.dylib",
    "*.exe", "*.jar", "*.war", "*.ear",
    "*.log", "*.tmp", "*.temp",
    "Thumbs.db", ".DS_Store", "desktop.ini"
]


@dataclass
class Config:
    """Configuration dataclass"""
    parent_folder: str = DEFAULT_PARENT
    proxy_enabled: bool = False
    proxy_address: str = "127.0.0.1"
    proxy_port: int = 10808
    proxy_user: str = ""
    proxy_pass: str = ""
    download_proxy_enabled: bool = False
    download_proxy_address: str = "127.0.0.1"
    download_proxy_port: int = 10808
    download_proxy_user: str = ""
    download_proxy_pass: str = ""

    def to_dict(self) -> Dict[str, Any]:
        return asdict(self)

    @classmethod
    def from_dict(cls, data: Dict[str, Any]) -> "Config":
        return cls(**{k: v for k, v in data.items() if k in cls.__dataclass_fields__})


def load_config(config_file: str = "config.json") -> Config:
    """Load configuration from file"""
    if os.path.exists(config_file):
        try:
            with open(config_file, "r", encoding="utf-8") as f:
                data = json.load(f)
                return Config.from_dict(data)
        except Exception:
            pass
    return Config()


def save_config(config: Config, config_file: str = "config.json") -> None:
    """Save configuration to file"""
    with open(config_file, "w", encoding="utf-8") as f:
        json.dump(config.to_dict(), f, indent=2)


def get_7z_path() -> str:
    """Get 7z executable path"""
    paths = [
        r"C:\Program Files\7-Zip\7z.exe",
        r"C:\Program Files (x86)\7-Zip\77z.exe",
        "7z"
    ]
    for p in paths:
        if p == "7z" or os.path.exists(p):
            return p
    return "7z"


def get_folder(subfolder: str, config: Optional[Config] = None) -> str:
    """Get folder path"""
    if config is None:
        config = load_config()
    return os.path.join(config.parent_folder or DEFAULT_PARENT, subfolder)


def ensure_folders(config: Optional[Config] = None) -> None:
    """Ensure required folders exist"""
    if config is None:
        config = load_config()
    for folder in ["github", "compress", "extract", "download"]:
        dir_path = get_folder(folder, config)
        os.makedirs(dir_path, exist_ok=True)


def should_exclude(file_path: str) -> bool:
    """Check if file should be excluded"""
    name = os.path.basename(file_path)
    for pattern in EXCLUDE_PATTERNS:
        if pattern.startswith("*"):
            if name.endswith(pattern[1:]):
                return True
        elif name == pattern or pattern in name:
            return True
    return False


def run_command(cmd: str, cwd: Optional[str] = None) -> Tuple[str, str]:
    """Run shell command"""
    result = subprocess.run(
        cmd,
        cwd=cwd,
        capture_output=True,
        text=True,
        shell=True,
        encoding="utf-8",
        errors="ignore"
    )
    if result.returncode != 0:
        raise Exception(f"Command failed: {result.stderr}")
    return result.stdout, result.stderr


def generate_id() -> str:
    """Generate random ID"""
    import secrets
    return secrets.token_hex(8)


def build_git_clone_command(url: str, target_path: str, config: Config) -> str:
    """Build git clone command with proxy"""
    proxy_port = config.proxy_port or 10808
    proxy_address = config.proxy_address or "127.0.0.1"

    if not config.proxy_enabled:
        return f'git clone "{url}" "{target_path}"'

    if config.proxy_user and config.proxy_pass:
        proxy = f"http://{config.proxy_user}:{config.proxy_pass}@{proxy_address}:{proxy_port}"
    else:
        proxy = f"http://{proxy_address}:{proxy_port}"

    return f'git clone -c http.proxy={proxy} -c https.proxy={proxy} "{url}" "{target_path}"'


def build_curl_command(url: str, file_path: str, config: Config) -> str:
    """Build curl command with proxy"""
    proxy_port = config.download_proxy_port or 10808
    proxy_address = config.download_proxy_address or "127.0.0.1"

    if not config.download_proxy_enabled:
        return f'curl -L -o "{file_path}" "{url}"'

    if config.download_proxy_user and config.download_proxy_pass:
        proxy = f"http://{config.download_proxy_user}:{config.download_proxy_pass}@{proxy_address}:{proxy_port}"
    else:
        proxy = f"http://{proxy_address}:{proxy_port}"

    return f'curl -x {proxy} -L -o "{file_path}" "{url}"'


def walk_dir_for_merge(source_folder: str, write_file) -> Dict[str, int]:
    """Walk directory and merge files"""
    file_count = 0
    skip_count = 0

    def walk(dir_path: str):
        nonlocal file_count, skip_count
        try:
            items = os.listdir(dir_path)
        except PermissionError:
            return

        dirs = sorted([i for i in items if os.path.isdir(os.path.join(dir_path, i))])
        files = sorted([i for i in items if os.path.isfile(os.path.join(dir_path, i))])

        for d in dirs:
            if not should_exclude(d):
                walk(os.path.join(dir_path, d))

        for f in files:
            file_path = os.path.join(dir_path, f)
            if should_exclude(file_path):
                skip_count += 1
                continue

            rel_path = os.path.relpath(file_path, source_folder)
            write_file.write(f"\n===FILE:{rel_path}===\n")

            try:
                with open(file_path, "r", encoding="utf-8", errors="ignore") as rf:
                    write_file.write(rf.read())
            except Exception:
                write_file.write("[Binary file or read error]")

            write_file.write("\n===END===\n")
            file_count += 1

    walk(source_folder)
    return {"file_count": file_count, "skip_count": skip_count}


def extract_txt_to_folder(content: str, out_dir: str) -> Dict[str, int]:
    """Extract merged TXT to folder"""
    lines = content.split("\n")
    current_file = None
    current_content = []
    in_content = False
    file_count = 0

    for line in lines:
        if line.startswith("===MERGE_INFO:"):
            continue

        if line.startswith("===FILE:"):
            if current_file:
                full_path = os.path.join(out_dir, current_file.replace("\\", "/"))
                os.makedirs(os.path.dirname(full_path), exist_ok=True)
                with open(full_path, "w", encoding="utf-8") as f:
                    f.write("\n".join(current_content))
                file_count += 1
            current_file = line[8:].replace("===", "").strip()
            current_content = []
            in_content = True
        elif line.strip() == "===END===":
            if current_file:
                full_path = os.path.join(out_dir, current_file.replace("\\", "/"))
                os.makedirs(os.path.dirname(full_path), exist_ok=True)
                with open(full_path, "w", encoding="utf-8") as f:
                    f.write("\n".join(current_content))
                file_count += 1
                current_file = None
                current_content = []
                in_content = False
        elif in_content and current_file is not None:
            current_content.append(line)

    if current_file:
        full_path = os.path.join(out_dir, current_file.replace("\\", "/"))
        os.makedirs(os.path.dirname(full_path), exist_ok=True)
        with open(full_path, "w", encoding="utf-8") as f:
            f.write("\n".join(current_content))
        file_count += 1

    return {"file_count": file_count}


class ShareToolsAPI:
    """ShareTools API class"""

    @staticmethod
    async def github_clone(url: str, config_file: str = "config.json") -> Dict[str, Any]:
        """Clone a GitHub repository"""
        if not url:
            raise ValueError("URL is required")

        config = load_config(config_file)
        target_dir = get_folder("github", config)
        os.makedirs(target_dir, exist_ok=True)

        repo_name = url.replace(".git", "").split("/")[-1]
        target_path = os.path.join(target_dir, repo_name)

        if os.path.exists(target_path):
            shutil.rmtree(target_path)

        # Only pass repo_name to git clone, not full path (git runs in target_dir)
        cmd = build_git_clone_command(url, repo_name, config)
        run_command(cmd, target_dir)

        return {"success": True, "path": target_path}

    @staticmethod
    async def github_download(url: str, config_file: str = "config.json") -> Dict[str, Any]:
        """Download a single file from GitHub"""
        if not url:
            raise ValueError("URL is required")

        config = load_config(config_file)

        # Convert GitHub URL to raw URL
        if "github.com" in url and "raw.githubusercontent.com" not in url:
            raw_url = url.replace("github.com", "raw.githubusercontent.com").replace("/blob/", "/")
        else:
            raw_url = url

        download_dir = get_folder("download", config)
        os.makedirs(download_dir, exist_ok=True)

        file_name = raw_url.split("/")[-1] or "download"
        file_path = os.path.join(download_dir, file_name)

        cmd = build_curl_command(raw_url, file_path, config)
        run_command(cmd)

        if not os.path.exists(file_path):
            raise Exception("Download failed")

        return {"success": True, "path": file_path}

    @staticmethod
    async def compress_zip(source_folder: str, output_folder: Optional[str] = None,
                           config_file: str = "config.json") -> Dict[str, Any]:
        """Compress folder to base64 ZIP"""
        if not source_folder or not os.path.exists(source_folder):
            raise ValueError("Invalid source folder")

        config = load_config(config_file)
        out_dir = output_folder or get_folder("compress", config)
        os.makedirs(out_dir, exist_ok=True)

        folder_name = os.path.basename(source_folder)
        temp_zip = os.path.join(tempfile.gettempdir(), f"{folder_name}_{generate_id()}.zip")

        # Build exclude arguments - use simpler wildcard patterns
        exclude_args = []
        for pattern in EXCLUDE_PATTERNS:
            if pattern.startswith("*"):
                # Extension patterns like *.pyc
                exclude_args.append(f'-x!{pattern}')
            else:
                # Directory/file patterns - just use the pattern with wildcard
                exclude_args.append(f'-x!{pattern}')

        cmd = f'"{get_7z_path()}" a -r -tzip "{temp_zip}" "{source_folder}\\*" {" ".join(exclude_args)}'
        run_command(cmd)

        if not os.path.exists(temp_zip):
            raise Exception("Failed to create ZIP")

        with open(temp_zip, "rb") as f:
            zip_content = f.read()

        base64_content = base64.b64encode(zip_content).decode("utf-8")
        size_kb = (len(zip_content) + 1023) // 1024

        output_path = os.path.join(out_dir, f"BS64_{size_kb}K_{folder_name}.txt")
        with open(output_path, "w", encoding="utf-8") as f:
            f.write(base64_content)

        os.remove(temp_zip)

        return {"success": True, "outputPath": output_path}

    @staticmethod
    async def compress_txt(source_folder: str, output_folder: Optional[str] = None,
                           config_file: str = "config.json") -> Dict[str, Any]:
        """Merge folder to TXT"""
        if not source_folder or not os.path.exists(source_folder):
            raise ValueError("Invalid source folder")

        config = load_config(config_file)
        out_dir = output_folder or get_folder("compress", config)
        os.makedirs(out_dir, exist_ok=True)

        folder_name = os.path.basename(source_folder)
        output_path = os.path.join(out_dir, f"{folder_name}.txt")

        with open(output_path, "w", encoding="utf-8") as wf:
            wf.write(f"===MERGE_INFO:folder={folder_name}===\n")
            result = walk_dir_for_merge(source_folder, wf)

        stats = os.stat(output_path)
        size_kb = (stats.st_size + 1023) // 1024
        final_path = os.path.join(out_dir, f"MERGE_{size_kb}K_{folder_name}.txt")
        os.rename(output_path, final_path)

        return {
            "success": True,
            "outputPath": final_path,
            "fileCount": result["file_count"],
            "skipCount": result["skip_count"]
        }

    @staticmethod
    async def extract_zip(input_file: str, output_folder: Optional[str] = None,
                          config_file: str = "config.json") -> Dict[str, Any]:
        """Extract base64 ZIP"""
        if not input_file or not os.path.exists(input_file):
            raise ValueError("Invalid input file")

        config = load_config(config_file)
        base_out_dir = output_folder or get_folder("extract", config)
        os.makedirs(base_out_dir, exist_ok=True)

        out_dir = os.path.join(base_out_dir, os.path.splitext(os.path.basename(input_file))[0])
        os.makedirs(out_dir, exist_ok=True)

        with open(input_file, "rb") as f:
            raw_content = f.read()

        # Check if content is base64
        content_str = raw_content.decode("utf-8", errors="ignore").strip()
        is_base64 = bool(re.match(r'^[A-Za-z0-9+/=]+$', content_str)) and len(raw_content) % 4 == 0

        if is_base64:
            zip_buffer = base64.b64decode(content_str)
        else:
            zip_buffer = raw_content

        temp_zip = os.path.join(tempfile.gettempdir(), f"extract_{generate_id()}.zip")

        with open(temp_zip, "wb") as f:
            f.write(zip_buffer)

        cmd = f'"{get_7z_path()}" x -y -o"{out_dir}" "{temp_zip}"'
        run_command(cmd)
        os.remove(temp_zip)

        return {"success": True, "outputPath": out_dir}

    @staticmethod
    async def extract_txt(input_file: str, output_folder: Optional[str] = None,
                          config_file: str = "config.json") -> Dict[str, Any]:
        """Extract from merged TXT"""
        if not input_file or not os.path.exists(input_file):
            raise ValueError("Invalid input file")

        config = load_config(config_file)
        base_out_dir = output_folder or get_folder("extract", config)
        os.makedirs(base_out_dir, exist_ok=True)

        out_dir = os.path.join(base_out_dir, os.path.splitext(os.path.basename(input_file))[0])
        os.makedirs(out_dir, exist_ok=True)

        with open(input_file, "r", encoding="utf-8", errors="ignore") as f:
            content = f.read()

        result = extract_txt_to_folder(content, out_dir)

        return {"success": True, "outputPath": out_dir, "fileCount": result["file_count"]}

    @staticmethod
    def get_config(config_file: str = "config.json") -> Dict[str, Any]:
        """Get current configuration"""
        return load_config(config_file).to_dict()

    @staticmethod
    def set_config(params: Dict[str, Any], config_file: str = "config.json") -> Dict[str, Any]:
        """Set configuration"""
        config = Config.from_dict(params)
        save_config(config, config_file)
        ensure_folders(config)
        return {"success": True}

    @staticmethod
    async def browse_folder(target_path: Optional[str] = None) -> Dict[str, Any]:
        """Browse folder contents"""
        dir_path = target_path or os.path.expanduser("~")
        if not os.path.exists(dir_path):
            raise ValueError("Path not found")

        items = []
        try:
            for name in os.listdir(dir_path):
                full_path = os.path.join(dir_path, name)
                try:
                    stat = os.stat(full_path)
                    items.append({
                        "name": name,
                        "isDirectory": os.path.isdir(full_path),
                        "size": stat.st_size,
                        "modified": datetime.fromtimestamp(stat.st_mtime).isoformat()
                    })
                except (OSError, PermissionError):
                    continue
        except PermissionError:
            pass

        return {"path": dir_path, "items": items}

    @staticmethod
    async def browse_file(file_path: str, filter_ext: Optional[str] = None) -> Dict[str, Any]:
        """Browse file or folder"""
        if not file_path or not os.path.exists(file_path):
            raise ValueError("File not found")

        stat = os.stat(file_path)

        if os.path.isdir(file_path):
            items = []
            try:
                for name in os.listdir(file_path):
                    if filter_ext and not name.endswith(filter_ext):
                        continue
                    items.append({
                        "name": name,
                        "isDirectory": os.path.isdir(os.path.join(file_path, name))
                    })
            except PermissionError:
                pass
            return {"path": file_path, "items": items}
        else:
            with open(file_path, "rb") as f:
                content = f.read()
            return {
                "path": file_path,
                "size": stat.st_size,
                "base64": base64.b64encode(content).decode("utf-8")
            }

    @staticmethod
    def get_folders(config_file: str = "config.json") -> Dict[str, str]:
        """Get configured folder paths"""
        config = load_config(config_file)
        parent = config.parent_folder or DEFAULT_PARENT
        return {
            "github": os.path.join(parent, "github"),
            "compress": os.path.join(parent, "compress"),
            "extract": os.path.join(parent, "extract"),
            "download": os.path.join(parent, "download")
        }


# Create API instance for easy import
api = ShareToolsAPI()

===END===

===FILE:requirements.txt===
# DevToolkit Python Dependencies

# FastAPI and web server
fastapi>=0.129.0
uvicorn[standard]>=0.40.0

# MCP Server
fastmcp>=2.14.5

# Data validation
pydantic>=2.12.5

===END===

===FILE:server.py===
"""
ShareTools FastAPI Web Server
Provides HTTP API endpoints and MCP integration for ShareTools operations.
"""

import os
import sys
import getpass
import re
import asyncio
import warnings
import webbrowser
from typing import Optional, Dict, Any
from contextlib import asynccontextmanager

# Filter websockets deprecation warnings
warnings.filterwarnings("ignore", category=DeprecationWarning, module="websockets")
warnings.filterwarnings("ignore", category=DeprecationWarning, module="uvicorn")

from fastapi import FastAPI, HTTPException, Query
from fastapi.staticfiles import StaticFiles
from fastapi.responses import JSONResponse
from pydantic import BaseModel, Field
import uvicorn

from core import api, ensure_folders, load_config

# ANSI color codes for terminal output
class Colors:
    HEADER = '\033[95m'
    BLUE = '\033[94m'
    CYAN = '\033[96m'
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    RED = '\033[91m'
    MAGENTA = '\033[35m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'
    END = '\033[0m'

    @staticmethod
    def colorize(text: str, *colors: str) -> str:
        """Apply colors to text"""
        return ''.join(colors) + text + Colors.END

WEB_PORT = 3000


# Request/Response Models
class GithubCloneRequest(BaseModel):
    url: str = Field(..., description="GitHub repository URL")


class GithubDownloadRequest(BaseModel):
    url: str = Field(..., description="GitHub file URL")


class CompressRequest(BaseModel):
    sourceFolder: str = Field(..., description="Source folder path")
    outputFolder: Optional[str] = Field(None, description="Output folder path")


class ExtractRequest(BaseModel):
    inputFile: str = Field(..., description="Input file path")
    outputFolder: Optional[str] = Field(None, description="Output folder path")


class ConfigRequest(BaseModel):
    parent_folder: Optional[str] = None
    proxy_enabled: Optional[bool] = None
    proxy_address: Optional[str] = None
    proxy_port: Optional[int] = None
    proxy_user: Optional[str] = None
    proxy_pass: Optional[str] = None
    download_proxy_enabled: Optional[bool] = None
    download_proxy_address: Optional[str] = None
    download_proxy_port: Optional[int] = None
    download_proxy_user: Optional[str] = None
    download_proxy_pass: Optional[str] = None


class BrowseFileRequest(BaseModel):
    path: str = Field(..., description="File or folder path")
    filter: Optional[str] = Field(None, description="File filter extension")


def create_mcp_server():
    """Create MCP server with ShareTools tools"""
    from fastmcp import FastMCP
    
    mcp = FastMCP("ShareTools")
    
    @mcp.tool()
    async def sharetools_github_clone(url: str) -> str:
        """ShareTools: Clone a GitHub repository"""
        result = await api.github_clone(url)
        return f"Successfully cloned to: {result['path']}"

    @mcp.tool()
    async def sharetools_github_download(url: str) -> str:
        """ShareTools: Download a single file from GitHub"""
        result = await api.github_download(url)
        return f"Successfully downloaded to: {result['path']}"

    @mcp.tool()
    async def sharetools_compress_zip(source_folder: str, output_folder: Optional[str] = None) -> str:
        """ShareTools: Compress folder to base64 ZIP"""
        result = await api.compress_zip(source_folder, output_folder)
        return f"Successfully compressed to: {result['outputPath']}"

    @mcp.tool()
    async def sharetools_compress_txt(source_folder: str, output_folder: Optional[str] = None) -> str:
        """ShareTools: Merge folder contents to a single TXT file"""
        result = await api.compress_txt(source_folder, output_folder)
        return f"Successfully merged {result.get('fileCount', 0)} files to: {result['outputPath']}"

    @mcp.tool()
    async def sharetools_extract_zip(input_file: str, output_folder: Optional[str] = None) -> str:
        """ShareTools: Extract base64 ZIP file"""
        result = await api.extract_zip(input_file, output_folder)
        return f"Successfully extracted to: {result['outputPath']}"

    @mcp.tool()
    async def sharetools_extract_txt(input_file: str, output_folder: Optional[str] = None) -> str:
        """ShareTools: Extract from merged TXT file"""
        result = await api.extract_txt(input_file, output_folder)
        return f"Successfully extracted {result.get('fileCount', 0)} files to: {result['outputPath']}"

    @mcp.tool()
    def sharetools_get_config() -> str:
        """ShareTools: Get current configuration"""
        import json
        config = api.get_config()
        return json.dumps(config, indent=2)

    @mcp.tool()
    def sharetools_set_config(
        parent_folder: Optional[str] = None,
        proxy_enabled: Optional[bool] = None,
        proxy_address: Optional[str] = None,
        proxy_port: Optional[int] = None,
        proxy_user: Optional[str] = None,
        proxy_pass: Optional[str] = None,
        download_proxy_enabled: Optional[bool] = None,
        download_proxy_address: Optional[str] = None,
        download_proxy_port: Optional[int] = None,
        download_proxy_user: Optional[str] = None,
        download_proxy_pass: Optional[str] = None
    ) -> str:
        """ShareTools: Set configuration"""
        params = {
            k: v for k, v in locals().items()
            if v is not None and k != "config_file"
        }
        api.set_config(params)
        return "Configuration updated successfully"

    @mcp.tool()
    async def sharetools_browse_folder(path: Optional[str] = None) -> str:
        """ShareTools: Browse folder contents"""
        result = await api.browse_folder(path)
        items_str = "\n".join([
            f"  {'[DIR]' if item['isDirectory'] else '[FILE]'} {item['name']}"
            for item in result['items'][:50]
        ])
        return f"Contents of {result['path']}:\n{items_str}"

    @mcp.tool()
    async def sharetools_browse_file(path: str, filter_ext: Optional[str] = None) -> str:
        """ShareTools: Browse file or folder"""
        result = await api.browse_file(path, filter_ext)
        if "items" in result:
            items_str = "\n".join([
                f"  {'[DIR]' if item['isDirectory'] else '[FILE]'} {item['name']}"
                for item in result['items'][:50]
            ])
            return f"Contents of {result['path']}:\n{items_str}"
        else:
            return f"File: {result['path']}\nSize: {result['size']} bytes\nBase64: {result['base64'][:100]}..."

    @mcp.tool()
    def sharetools_get_folders() -> str:
        """ShareTools: Get configured folder paths"""
        import json
        folders = api.get_folders()
        return json.dumps(folders, indent=2)
    
    return mcp


# Create MCP server and get HTTP app
mcp = create_mcp_server()
mcp_app = mcp.http_app(transport='http', path='/streamable-http')


# Create FastAPI application with MCP lifespan
app = FastAPI(
    title="ShareTools API",
    version="1.0.0",
    lifespan=mcp_app.lifespan
)


# API Routes
@app.get("/api/system-info")
async def system_info() -> Dict[str, Any]:
    """Get system information"""
    config = load_config()
    return {
        "platform": sys.platform,
        "user": getpass.getuser(),
        "parentFolder": config.parent_folder,
        "proxyEnabled": config.proxy_enabled,
        "downloadProxyEnabled": config.download_proxy_enabled
    }


@app.post("/api/github/clone")
async def github_clone(request: GithubCloneRequest) -> Dict[str, Any]:
    """Clone a GitHub repository"""
    try:
        return await api.github_clone(request.url)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.post("/api/github/download-file")
async def github_download(request: GithubDownloadRequest) -> Dict[str, Any]:
    """Download a single file from GitHub"""
    try:
        return await api.github_download(request.url)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.post("/api/compress/zip-base64")
async def compress_zip(request: CompressRequest) -> Dict[str, Any]:
    """Compress folder to base64 ZIP"""
    try:
        return await api.compress_zip(request.sourceFolder, request.outputFolder)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.post("/api/compress/txt")
async def compress_txt(request: CompressRequest) -> Dict[str, Any]:
    """Merge folder to TXT"""
    try:
        return await api.compress_txt(request.sourceFolder, request.outputFolder)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.post("/api/extract/zip-base64")
async def extract_zip(request: ExtractRequest) -> Dict[str, Any]:
    """Extract base64 ZIP"""
    try:
        return await api.extract_zip(request.inputFile, request.outputFolder)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.post("/api/extract/txt")
async def extract_txt(request: ExtractRequest) -> Dict[str, Any]:
    """Extract from merged TXT"""
    try:
        return await api.extract_txt(request.inputFile, request.outputFolder)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.get("/api/config")
async def get_config() -> Dict[str, Any]:
    """Get current configuration"""
    return api.get_config()


@app.post("/api/config")
async def set_config(request: ConfigRequest) -> Dict[str, Any]:
    """Set configuration"""
    try:
        params = {k: v for k, v in request.dict().items() if v is not None}
        return api.set_config(params)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.get("/api/browse/folder")
async def browse_folder(
    path: Optional[str] = Query(None, description="Folder path")
) -> Dict[str, Any]:
    """Browse folder contents"""
    try:
        return await api.browse_folder(path)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.get("/api/browse/file")
async def browse_file(
    path: str = Query(..., description="File or folder path"),
    filter: Optional[str] = Query(None, description="File extension filter")
) -> Dict[str, Any]:
    """Browse file or folder"""
    try:
        return await api.browse_file(path, filter)
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


# Mount MCP app at /mcp endpoint
app.mount("/mcp", mcp_app)

# Serve static files (if public folder exists)
if os.path.exists("public"):
    app.mount("/", StaticFiles(directory="public", html=True), name="static")


async def start_server():
    """Start combined Web API + MCP HTTP server on single port"""
    print()
    print(Colors.colorize("=" * 50, Colors.CYAN, Colors.BOLD))
    print(Colors.colorize("  ShareTools Server", Colors.CYAN, Colors.BOLD))
    print(Colors.colorize("=" * 50, Colors.CYAN, Colors.BOLD))
    print()
    print(Colors.colorize("Mode:", Colors.YELLOW), Colors.colorize("Web API + MCP HTTP (Single Port)", Colors.GREEN, Colors.BOLD))
    print()
    print(Colors.colorize("ðŸŒ Web API:", Colors.BLUE), f"http://localhost:{WEB_PORT}")
    print(Colors.colorize("ðŸ“š API Docs:", Colors.MAGENTA), f"http://localhost:{WEB_PORT}/docs")
    print(Colors.colorize("ðŸ”Œ MCP endpoint:", Colors.GREEN), f"http://localhost:{WEB_PORT}/mcp/streamable-http")
    print()
    
    # åœ¨åŽå°å¯åŠ¨æœåŠ¡å™¨
    config = uvicorn.Config(app, host="0.0.0.0", port=WEB_PORT, log_level="info")
    server = uvicorn.Server(config)
    
    # åˆ›å»ºä¸€ä¸ªä»»åŠ¡åœ¨æœåŠ¡å™¨å¯åŠ¨åŽæ‰“å¼€æµè§ˆå™¨
    async def open_browser_after_delay():
        # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨ï¼ˆå»¶è¿Ÿå‡ ç§’ï¼‰
        await asyncio.sleep(2)
        # å°è¯•æ‰“å¼€æµè§ˆå™¨åˆ°APIæ–‡æ¡£é¡µé¢
        webbrowser.open(f"http://localhost:{WEB_PORT}")
        
    # å¯åŠ¨æµè§ˆå™¨æ‰“å¼€ä»»åŠ¡
    asyncio.create_task(open_browser_after_delay())
    
    await server.serve()


async def start_mcp_stdio():
    """Start MCP server in stdio mode"""
    print()
    print(Colors.colorize("=" * 50, Colors.CYAN, Colors.BOLD))
    print(Colors.colorize("  ShareTools Server", Colors.CYAN, Colors.BOLD))
    print(Colors.colorize("=" * 50, Colors.CYAN, Colors.BOLD))
    print()
    print(Colors.colorize("Mode:", Colors.YELLOW), Colors.colorize("MCP Stdio Only", Colors.GREEN, Colors.BOLD))
    print()
    ensure_folders()
    await mcp.run_stdio_async()


async def main():
    """Main entry point"""
    args = sys.argv[1:]
    mode = args[0] if args else ""

    ensure_folders()

    if mode == "--mcp-stdio":
        await start_mcp_stdio()
    else:
        # Default: Combined mode (Web API + MCP on same port)
        await start_server()


if __name__ == "__main__":
    asyncio.run(main())

===END===

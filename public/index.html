<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DevToolkit</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-card: #1a1a24;
      --bg-card-hover: #22222e;
      --accent-primary: #6366f1;
      --accent-secondary: #818cf8;
      --accent-success: #10b981;
      --accent-warning: #f59e0b;
      --accent-error: #ef4444;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      --border-color: #2d2d3a;
      --glass-bg: rgba(26, 26, 36, 0.8);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    [data-theme="light"] {
      --bg-primary: #f8fafc;
      --bg-secondary: #f1f5f9;
      --bg-card: #ffffff;
      --bg-card-hover: #f8fafc;
      --accent-primary: #4f46e5;
      --accent-secondary: #6366f1;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-muted: #94a3b8;
      --border-color: #e2e8f0;
      --glass-bg: rgba(255, 255, 255, 0.9);
      --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      transition: background 0.3s ease, color 0.3s ease;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(ellipse 80% 50% at 20% -20%, rgba(99, 102, 241, 0.15), transparent),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(16, 185, 129, 0.1), transparent);
      pointer-events: none;
      z-index: 0;
    }

    [data-theme="light"] body::before {
      background: 
        radial-gradient(ellipse 80% 50% at 20% -20%, rgba(79, 70, 229, 0.1), transparent),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(16, 185, 129, 0.08), transparent);
    }

    .container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 20px 24px;
      position: relative;
      z-index: 1;
    }

    header {
      text-align: center;
      margin-bottom: 24px;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      font-weight: 300;
      margin-top: 8px;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 30px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      background: var(--bg-card);
    }

    .theme-icon {
      font-size: 18px;
      width: 24px;
      text-align: center;
    }

    .theme-text {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .settings-card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
    }

    .settings-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
    }

    .settings-header h2 {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .settings-icon {
      width: 32px;
      height: 32px;
      background: rgba(99, 102, 241, 0.15);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent-primary);
    }

    .settings-grid {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 16px;
      align-items: center;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .input-group label {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .input-wrapper {
      display: flex;
      gap: 8px;
    }

    input[type="text"] {
      flex: 1;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 12px 16px;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    input[type="text"].long-input {
      width: 100%;
    }

    input[type="password"] {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 12px 16px;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }

    input[type="password"]:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .checkbox-wrapper:hover {
      background: var(--bg-card-hover);
    }

    .checkbox-wrapper input {
      width: 18px;
      height: 18px;
      accent-color: var(--accent-primary);
      cursor: pointer;
    }

    .checkbox-wrapper span {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-family: 'Outfit', sans-serif;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-primary), #4f46e5);
      color: white;
      box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(99, 102, 241, 0.4);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--accent-success), #059669);
      color: white;
      box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);
    }

    .btn-accent {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
      color: white;
      box-shadow: 0 4px 16px rgba(6, 182, 212, 0.3);
    }

    .btn-accent:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(6, 182, 212, 0.4);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      background: var(--bg-secondary);
      padding: 6px;
      border-radius: 14px;
    }

    .tab {
      flex: 1;
      padding: 14px 20px;
      background: transparent;
      border: none;
      border-radius: 10px;
      color: var(--text-muted);
      font-family: 'Outfit', sans-serif;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab.active {
      background: var(--bg-card);
      color: var(--text-primary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .tab:hover:not(.active) {
      color: var(--text-secondary);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 20px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .card-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .card-icon.github { background: rgba(16, 185, 129, 0.15); }
    .card-icon.compress { background: rgba(99, 102, 241, 0.15); }
    .card-icon.extract { background: rgba(6, 182, 212, 0.15); }

    .card-title h3 {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .card-title p {
      font-size: 0.85rem;
      color: var(--text-muted);
      font-weight: 400;
    }

    .form-group {
      margin-bottom: 12px;
    }

    .form-group label {
      display: block;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
      font-weight: 500;
    }

    .file-input-wrapper {
      display: flex;
      gap: 10px;
    }

    .file-input-wrapper input {
      flex: 1;
    }

    .file-input-wrapper .btn {
      white-space: nowrap;
    }

    .note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 8px;
      font-style: italic;
    }

    .btn-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 24px;
    }

    .btn-group .btn {
      width: 100%;
    }

    .status-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      padding: 12px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 100;
      transition: all 0.3s ease;
    }

    .status-text {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent-success);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .status-spinner {
      display: none;
      width: 16px;
      height: 16px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent-primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .status-bar.loading .status-spinner {
      display: block;
    }

    .status-bar.loading .status-dot {
      display: none;
    }

    .toast {
      position: fixed;
      top: 24px;
      right: 24px;
      padding: 16px 24px;
      border-radius: 12px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      animation: slideIn 0.3s ease;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .toast.success { background: linear-gradient(135deg, var(--accent-success), #059669); }
    .toast.error { background: linear-gradient(135deg, var(--accent-error), #dc2626); }
    .toast.warning { background: linear-gradient(135deg, var(--accent-warning), #d97706); }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .main-content {
      padding-bottom: 80px;
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-box {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 32px;
      width: 100%;
      max-width: 1300px;
      margin: 0 24px;
      box-shadow: var(--shadow-lg);
      transform: scale(0.9) translateY(20px);
      transition: all 0.3s ease;
    }

    .modal-overlay.active .modal-box {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .modal-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-subtitle {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .modal-input {
      width: 100%;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 14px 18px;
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      transition: all 0.2s ease;
      margin-bottom: 20px;
    }

    .modal-input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .modal-actions .btn {
      padding: 12px 24px;
      min-width: 100px;
    }

    /* Log panel styles */
    .log-panel {
      position: fixed;
      top: 0;
      right: 0;
      height: 100vh;
      z-index: 1500;
      display: flex;
    }

    .log-trigger {
      width: 6px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
      cursor: pointer;
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.6;
    }

    .log-trigger:hover {
      width: 10px;
      opacity: 1;
    }

    .log-trigger-icon {
      writing-mode: vertical-rl;
      text-orientation: mixed;
      color: white;
      font-size: 12px;
      font-weight: 500;
      letter-spacing: 2px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .log-trigger:hover .log-trigger-icon {
      opacity: 1;
    }

    .log-content {
      width: 0;
      height: 100%;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border-left: 1px solid var(--border-color);
      box-shadow: -10px 0 40px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
    }

    .log-panel:hover .log-content {
      width: 1300px;
    }

    .log-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    .log-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .log-header-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .log-clear-btn {
      padding: 8px 16px;
      font-size: 0.8rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .log-clear-btn:hover {
      background: var(--accent-error);
      border-color: var(--accent-error);
      color: white;
    }

    .log-list {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .log-list::-webkit-scrollbar {
      width: 6px;
    }

    .log-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .log-list::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 3px;
    }

    .log-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      animation: logSlideIn 0.3s ease;
    }

    @keyframes logSlideIn {
      from {
        opacity: 0;
        transform: translateX(20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .log-item-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .log-item-icon {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
    }

    .log-item-icon.clone { background: rgba(16, 185, 129, 0.15); }
    .log-item-icon.download { background: rgba(6, 182, 212, 0.15); }
    .log-item-icon.compress { background: rgba(99, 102, 241, 0.15); }
    .log-item-icon.extract { background: rgba(245, 158, 11, 0.15); }

    .log-item-type {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--text-primary);
    }

    .log-item-time {
      margin-left: auto;
      font-size: 0.75rem;
      color: var(--text-muted);
      font-family: 'JetBrains Mono', monospace;
    }

    .log-item-message {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .log-item-path {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 10px 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--accent-secondary);
      word-break: break-all;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .log-item-path:hover {
      background: var(--bg-card);
      border-color: var(--accent-primary);
    }

    .log-item-path-icon {
      color: var(--text-muted);
      flex-shrink: 0;
    }

    .log-empty {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
    }

    .log-empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .log-empty-text {
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="theme-toggle" onclick="toggleTheme()">
    <span class="theme-icon" id="themeIcon">üåô</span>
    <span class="theme-text" id="themeText">Dark</span>
  </div>

  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">‚ö°</div>
        <h1>DevToolkit</h1>
      </div>
      <p class="subtitle">Developer Utilities Suite</p>
    </header>

    <div class="settings-card">
      <div class="settings-header">
        <div class="settings-icon">‚öô</div>
        <h2>Settings</h2>
      </div>
      <div class="settings-grid">
        <div class="input-group">
          <label>Parent Folder</label>
          <div class="input-wrapper">
            <input type="text" id="parentFolder" placeholder="ABC folder">
            <button class="btn btn-secondary" onclick="browseFolder('parentFolder')">Browse</button>
          </div>
        </div>
      </div>
      <div class="input-group" style="margin-top: 12px;">
        <label>Clone Proxy (Home only)</label>
        <div id="proxySection" style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
          <label class="checkbox-wrapper" style="background: transparent; padding: 6px 10px;">
            <input type="checkbox" id="proxyEnabled">
            <span>Enable</span>
          </label>
          <input type="text" id="proxyAddress" placeholder="127.0.0.1" style="width: 100px; text-align: center;">
          <input type="text" id="proxyPort" placeholder="Port" style="width: 60px; text-align: center;">
          <input type="text" id="proxyUser" placeholder="Username" style="width: 100px;">
          <input type="password" id="proxyPass" placeholder="Password" style="width: 100px;">
        </div>
      </div>
      <div class="input-group" style="margin-top: 12px;">
        <label>Download Proxy (Company only)</label>
        <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
          <label class="checkbox-wrapper" style="background: transparent; padding: 6px 10px;">
            <input type="checkbox" id="downloadProxyEnabled">
            <span>Enable</span>
          </label>
          <input type="text" id="downloadProxyAddress" placeholder="127.0.0.1" style="width: 100px; text-align: center;">
          <input type="text" id="downloadProxyPort" placeholder="Port" style="width: 60px; text-align: center;">
          <input type="text" id="downloadProxyUser" placeholder="Username" style="width: 100px;">
          <input type="password" id="downloadProxyPass" placeholder="Password" style="width: 100px;">
        </div>
      </div>
      <div style="margin-top: 16px; text-align: right;">
        <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
      </div>
    </div>

    <div class="tabs">
      <button class="tab" data-tab="github">GitHub Clone</button>
      <button class="tab" data-tab="download">Download</button>
      <button class="tab" data-tab="compress">Compress</button>
      <button class="tab" data-tab="extract">Extract</button>
    </div>

    <div class="main-content">
      <div class="tab-content" id="github-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon github">üì¶</div>
            <div>
              <h3>Clone Repository</h3>
              <p>Clone a GitHub repository to your local folder</p>
            </div>
          </div>
          <div class="form-group">
            <label>Repository URL</label>
            <input type="text" id="githubUrl" class="long-input" placeholder="https://github.com/username/repository.git">
            <p class="note">Example: https://github.com/facebook/react.git</p>
          </div>
          <button class="btn btn-success" style="width: 100%;" onclick="cloneRepo()" id="cloneBtn">
            Clone Repository
          </button>
        </div>
      </div>

      <div class="tab-content" id="download-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon github">üì•</div>
            <div>
              <h3>Download File</h3>
              <p>Download a single file from GitHub</p>
            </div>
          </div>
          <div class="form-group">
            <label>File URL</label>
            <input type="text" id="downloadUrl" class="long-input" placeholder="https://github.com/username/repo/blob/main/file.txt">
            <p class="note">Will be converted to raw URL automatically</p>
          </div>
          <button class="btn btn-success" style="width: 100%;" onclick="downloadFile()" id="downloadBtn">
            Download File
          </button>
        </div>
      </div>

      <div class="tab-content" id="compress-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon compress">üìÅ</div>
            <div>
              <h3>Compress Folder</h3>
              <p>Package folder to portable format</p>
            </div>
          </div>
          <div class="form-group">
            <label>Source Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="compressSource" placeholder="Select folder to compress">
              <button class="btn btn-secondary" onclick="browseFolder('compressSource')">Browse</button>
            </div>
          </div>
          <div class="form-group">
            <label>Output Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="compressOutput" placeholder="Select output folder">
              <button class="btn btn-secondary" onclick="browseFolder('compressOutput')">Browse</button>
            </div>
            <p class="note">Note: Excludes .git, node_modules, target, build, __pycache__, etc.</p>
          </div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="compressZipBase64()" id="zipBtn">
              ZIP + Base64
            </button>
            <button class="btn btn-accent" onclick="compressTxt()" id="txtBtn">
              Merge to TXT
            </button>
          </div>
        </div>
      </div>

      <div class="tab-content" id="extract-tab">
        <div class="card">
          <div class="card-title">
            <div class="card-icon extract">üì§</div>
            <div>
              <h3>Extract Files</h3>
              <p>Extract files from archive</p>
            </div>
          </div>
          <div class="form-group">
            <label>Input File</label>
            <div class="file-input-wrapper">
              <input type="text" id="extractInput" placeholder="Select file to extract">
              <button class="btn btn-secondary" onclick="browseFile('extractInput')">Browse</button>
            </div>
          </div>
          <div class="form-group">
            <label>Output Folder</label>
            <div class="file-input-wrapper">
              <input type="text" id="extractOutput" placeholder="Select output folder">
              <button class="btn btn-secondary" onclick="browseFolder('extractOutput')">Browse</button>
            </div>
          </div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="extractZipBase64()" id="extractZipBtn">
              Extract ZIP+Base64
            </button>
            <button class="btn btn-accent" onclick="extractTxt()" id="extractTxtBtn">
              Extract TXT
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="status-bar" id="statusBar">
    <div class="status-text">
      <div class="status-spinner"></div>
      <div class="status-dot"></div>
      <span id="statusText">Ready</span>
    </div>
    <div style="font-size: 0.8rem; color: var(--text-muted);">
      Folders: <span id="folderInfo">-</span>
    </div>
  </div>

  <!-- Modal dialog -->
  <div class="modal-overlay" id="pathModal" onclick="if(event.target === this) closeModal()">
    <div class="modal-box" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div class="modal-icon" id="modalIcon">üìÅ</div>
        <div>
          <div class="modal-title" id="modalTitle">Select Folder</div>
          <div class="modal-subtitle" id="modalSubtitle">Please enter the path</div>
        </div>
      </div>
      <input type="text" class="modal-input" id="modalInput" placeholder="Enter path...">
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="confirmModal()">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Log panel -->
  <div class="log-panel" id="logPanel">
    <div class="log-trigger">
      <span class="log-trigger-icon">LOGS</span>
    </div>
    <div class="log-content">
      <div class="log-header">
        <h3>
          <div class="log-header-icon">üìã</div>
          Operation Logs
        </h3>
        <button class="log-clear-btn" onclick="clearLogs()">Clear All</button>
      </div>
      <div class="log-list" id="logList">
        <div class="log-empty" id="logEmpty">
          <div class="log-empty-icon">üì≠</div>
          <div class="log-empty-text">No operation records</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = '';
    let config = {};

    // Get input value and automatically remove surrounding quotes
    function getInputValue(inputId) {
      const element = document.getElementById(inputId);
      if (!element) return '';
      let value = element.value.trim();
      // Auto remove surrounding quotes from path
      if ((value.startsWith('"') && value.endsWith('"')) ||
          (value.startsWith("'") && value.endsWith("'"))) {
        value = value.slice(1, -1);
      }
      return value;
    }

    // Log system
    const LOG_STORAGE_KEY = 'devtoolkit_logs';
    const MAX_LOGS = 100;

    const LOG_TYPES = {
      clone: { icon: 'üì¶', label: 'GitHub Clone', cssClass: 'clone' },
      download: { icon: 'üì•', label: 'File Download', cssClass: 'download' },
      'compress-zip': { icon: 'üóúÔ∏è', label: 'ZIP+Base64 Compress', cssClass: 'compress' },
      'compress-txt': { icon: 'üìÑ', label: 'TXT Merge', cssClass: 'compress' },
      'extract-zip': { icon: 'üì§', label: 'ZIP+Base64 Extract', cssClass: 'extract' },
      'extract-txt': { icon: 'üìù', label: 'TXT Extract', cssClass: 'extract' }
    };

    function getLogs() {
      try {
        return JSON.parse(localStorage.getItem(LOG_STORAGE_KEY) || '[]');
      } catch {
        return [];
      }
    }

    function saveLogs(logs) {
      localStorage.setItem(LOG_STORAGE_KEY, JSON.stringify(logs));
    }

    function addLog(type, message, path) {
      const logs = getLogs();
      const logType = LOG_TYPES[type] || { icon: 'üìå', label: 'Operation', cssClass: '' };

      const newLog = {
        id: Date.now(),
        type: type,
        icon: logType.icon,
        label: logType.label,
        cssClass: logType.cssClass,
        message: message,
        path: path || '',
        time: new Date().toLocaleString('zh-CN', {
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        })
      };

      logs.unshift(newLog);
      if (logs.length > MAX_LOGS) {
        logs.pop();
      }
      saveLogs(logs);
      renderLogs();
    }

    function clearLogs() {
      localStorage.removeItem(LOG_STORAGE_KEY);
      renderLogs();
    }

    function copyPath(path) {
      navigator.clipboard.writeText(path).then(() => {
        showToast('Path copied to clipboard');
      }).catch(() => {
        // Fallback method
        const textarea = document.createElement('textarea');
        textarea.value = path;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('Path copied to clipboard');
      });
    }

    function renderLogs() {
      const logs = getLogs();
      const logList = document.getElementById('logList');
      const logEmpty = document.getElementById('logEmpty');

      if (logs.length === 0) {
        logList.innerHTML = `
          <div class="log-empty" id="logEmpty">
            <div class="log-empty-icon">üì≠</div>
            <div class="log-empty-text">No operation records</div>
          </div>
        `;
        return;
      }

      logList.innerHTML = logs.map(log => `
        <div class="log-item">
          <div class="log-item-header">
            <div class="log-item-icon ${log.cssClass}">${log.icon}</div>
            <span class="log-item-type">${log.label}</span>
            <span class="log-item-time">${log.time}</span>
          </div>
          <div class="log-item-message">${log.message}</div>
          ${log.path ? `
            <div class="log-item-path" onclick="copyPath('${log.path.replace(/\\/g, '\\\\')}')" title="Click to copy path">
              <span class="log-item-path-icon">üìã</span>
              <span>${log.path}</span>
            </div>
          ` : ''}
        </div>
      `).join('');
    }

    // Load logs on initialization
    renderLogs();

    function getTheme() {
      return localStorage.getItem('theme') || 'dark';
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      document.getElementById('themeIcon').textContent = theme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      document.getElementById('themeText').textContent = theme === 'dark' ? 'Dark' : 'Light';
    }

    function toggleTheme() {
      const current = getTheme();
      setTheme(current === 'dark' ? 'light' : 'dark');
    }

    setTheme(getTheme());

    async function api(endpoint, options = {}) {
      const response = await fetch(`${API_BASE}${endpoint}`, {
        ...options,
        headers: {
          'Content-Type': 'application/json',
          ...options.headers
        }
      });
      return response.json();
    }

    async function init() {
      // Load from localStorage first
      const stored = JSON.parse(localStorage.getItem('devtoolkit_config') || '{}');
      
      const systemInfo = await api('/api/system-info');
      const isNumericUsername = systemInfo.isNumericUsername;
      
      // Merge stored with defaults
      config = {
        parent_folder: stored.parent_folder || 'ABC folder',
        proxy_enabled: stored.proxy_enabled || false,
        proxy_address: stored.proxy_address || '127.0.0.1',
        proxy_port: stored.proxy_port || 10808,
        proxy_user: stored.proxy_user || '',
        proxy_pass: stored.proxy_pass || '',
        download_proxy_enabled: stored.download_proxy_enabled || false,
        download_proxy_address: stored.download_proxy_address || '127.0.0.1',
        download_proxy_port: stored.download_proxy_port || 10808,
        download_proxy_user: stored.download_proxy_user || '',
        download_proxy_pass: stored.download_proxy_pass || ''
      };
      
      document.getElementById('parentFolder').value = config.parent_folder;
      document.getElementById('proxyEnabled').checked = config.proxy_enabled;
      document.getElementById('proxyAddress').value = config.proxy_address;
      document.getElementById('proxyPort').value = config.proxy_port;
      document.getElementById('proxyUser').value = config.proxy_user;
      document.getElementById('proxyPass').value = config.proxy_pass;
      document.getElementById('downloadProxyEnabled').checked = config.download_proxy_enabled;
      document.getElementById('downloadProxyAddress').value = config.download_proxy_address;
      document.getElementById('downloadProxyPort').value = config.download_proxy_port;
      document.getElementById('downloadProxyUser').value = config.download_proxy_user;
      document.getElementById('downloadProxyPass').value = config.download_proxy_pass;
      
      const folders = await api(`/api/folders?parent=${encodeURIComponent(config.parent_folder)}`);
      document.getElementById('folderInfo').textContent = 
        `github: ${folders.github}, compress: ${folders.compress}, extract: ${folders.extract}, download: ${folders.download}`;
      
      document.getElementById('compressOutput').value = folders.compress;
      document.getElementById('extractOutput').value = folders.extract;
      
      updateTabsVisibility(isNumericUsername);
    }

    function updateTabsVisibility(isNumericUsername) {
      const githubTab = document.querySelector('[data-tab="github"]');
      const proxySection = document.getElementById('proxySection');
      
      if (githubTab) {
        if (isNumericUsername) {
          githubTab.style.display = 'none';
          document.getElementById('github-tab').style.display = 'none';
          // Hide clone proxy settings
          if (proxySection) proxySection.style.display = 'none';
          // Default to download tab
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.querySelector('[data-tab="download"]').classList.add('active');
          document.getElementById('download-tab').classList.add('active');
        } else {
          githubTab.style.display = '';
          document.getElementById('github-tab').style.display = '';
          if (proxySection) proxySection.style.display = 'flex';
          // Default to github tab for non-numeric username
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.querySelector('[data-tab="github"]').classList.add('active');
          document.getElementById('github-tab').classList.add('active');
        }
      }
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
      });
    });

    function setStatus(text, loading = false) {
      const bar = document.getElementById('statusBar');
      document.getElementById('statusText').textContent = text;
      bar.classList.toggle('loading', loading);
    }

    function showToast(message, type = 'success') {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.remove(), 4000);
    }

    // Modal related variables
    let currentModalCallback = null;
    let currentInputId = null;

    // Open modal
    function openModal(options) {
      const modal = document.getElementById('pathModal');
      const icon = document.getElementById('modalIcon');
      const title = document.getElementById('modalTitle');
      const subtitle = document.getElementById('modalSubtitle');
      const input = document.getElementById('modalInput');

      icon.textContent = options.icon || 'üìÅ';
      title.textContent = options.title || 'Select Path';
      subtitle.textContent = options.subtitle || 'Please enter path';
      input.placeholder = options.placeholder || 'Enter path...';
      input.value = options.defaultValue || '';

      currentModalCallback = options.onConfirm;
      currentInputId = options.inputId;

      modal.classList.add('active');
      input.focus();
      input.select();

      // Support Enter key to confirm
      input.onkeydown = (e) => {
        if (e.key === 'Enter') {
          confirmModal();
        } else if (e.key === 'Escape') {
          closeModal();
        }
      };
    }

    // Close modal
    function closeModal() {
      const modal = document.getElementById('pathModal');
      modal.classList.remove('active');
      currentModalCallback = null;
      currentInputId = null;
    }

    // Confirm modal
    function confirmModal() {
      const input = document.getElementById('modalInput');
      let value = input.value.trim();

      // Auto remove surrounding quotes from path
      if ((value.startsWith('"') && value.endsWith('"')) ||
          (value.startsWith("'") && value.endsWith("'"))) {
        value = value.slice(1, -1);
      }

      if (value && currentInputId) {
        document.getElementById(currentInputId).value = value;
      }

      if (currentModalCallback) {
        currentModalCallback(value);
      }

      closeModal();
    }

    async function browseFolder(inputId) {
      const input = document.getElementById(inputId);
      openModal({
        icon: 'üìÅ',
        title: 'Select Folder',
        subtitle: 'Please enter the full folder path',
        placeholder: 'e.g.: C:\\Users\\Username\\Documents',
        defaultValue: input.value,
        inputId: inputId
      });
    }

    async function browseFile(inputId) {
      const input = document.getElementById(inputId);
      openModal({
        icon: 'üìÑ',
        title: 'Select File',
        subtitle: 'Please enter the full file path',
        placeholder: 'e.g.: C:\\Users\\Username\\file.txt',
        defaultValue: input.value,
        inputId: inputId
      });
    }

    async function saveSettings() {
      const parentFolder = getInputValue('parentFolder');
      const proxyEnabled = document.getElementById('proxyEnabled').checked;
      const proxyAddress = getInputValue('proxyAddress') || '127.0.0.1';
      const proxyPort = parseInt(getInputValue('proxyPort')) || 10808;
      const proxyUser = getInputValue('proxyUser');
      const proxyPass = getInputValue('proxyPass');
      const downloadProxyEnabled = document.getElementById('downloadProxyEnabled').checked;
      const downloadProxyAddress = getInputValue('downloadProxyAddress') || '127.0.0.1';
      const downloadProxyPort = parseInt(getInputValue('downloadProxyPort')) || 10808;
      const downloadProxyUser = getInputValue('downloadProxyUser');
      const downloadProxyPass = getInputValue('downloadProxyPass');
      
      // Save to localStorage
      const settings = {
        parent_folder: parentFolder,
        proxy_enabled: proxyEnabled,
        proxy_address: proxyAddress,
        proxy_port: proxyPort,
        proxy_user: proxyUser,
        proxy_pass: proxyPass,
        download_proxy_enabled: downloadProxyEnabled,
        download_proxy_address: downloadProxyAddress,
        download_proxy_port: downloadProxyPort,
        download_proxy_user: downloadProxyUser,
        download_proxy_pass: downloadProxyPass
      };
      localStorage.setItem('devtoolkit_config', JSON.stringify(settings));
      
      config = settings;
      
      const folders = await api(`/api/folders?parent=${encodeURIComponent(config.parent_folder)}`);
      document.getElementById('folderInfo').textContent = 
        `github: ${folders.github}, compress: ${folders.compress}, extract: ${folders.extract}, download: ${folders.download}`;
      document.getElementById('compressOutput').value = folders.compress;
      document.getElementById('extractOutput').value = folders.extract;
      
      showToast('Settings saved successfully!');
    }
    
    async function cloneRepo() {
      const url = document.getElementById('githubUrl').value.trim();
      if (!url) {
        showToast('Please enter a GitHub repository URL!', 'error');
        return;
      }
      
      setStatus('Cloning repository...', true);
      document.getElementById('cloneBtn').disabled = true;
      
      try {
        const result = await api('/api/github/clone', {
          method: 'POST',
          body: JSON.stringify({ url })
        });
        
        if (result.success) {
          showToast(`Repository cloned to: ${result.path}`);
          const repoName = url.replace(/\.git$/, '').split('/').pop();
          addLog('clone', `ÂÖãÈöÜ‰ªìÂ∫ì ${repoName} ÊàêÂäü`, result.path);
        } else {
          if (result.proxyStatus === 'available_not_used') {
            showToast(result.error + ' You can enable it in Settings.', 'warning');
          } else if (result.proxyStatus === 'not_open') {
            showToast(result.error, 'error');
          } else {
            showToast(result.error || 'Clone failed', 'error');
          }
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('cloneBtn').disabled = !document.getElementById('githubEnabled').checked;
    }

    async function compressZipBase64() {
      const sourceFolder = getInputValue('compressSource');
      const outputFolder = getInputValue('compressOutput');
      
      if (!sourceFolder) {
        showToast('Please select a source folder!', 'error');
        return;
      }
      
      setStatus('Creating ZIP with exclusions...', true);
      document.getElementById('zipBtn').disabled = true;
      
      try {
        const result = await api('/api/compress/zip-base64', {
          method: 'POST',
          body: JSON.stringify({ sourceFolder, outputFolder })
        });
        
        if (result.success) {
          showToast(`Saved to: ${result.outputPath}`);
          const folderName = sourceFolder.split(/[/\\]/).pop();
          addLog('compress-zip', `ÂéãÁº©Êñá‰ª∂Â§π ${folderName} ÊàêÂäü`, result.outputPath);
        } else {
          showToast(result.error || 'Compression failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('zipBtn').disabled = false;
    }

    async function compressTxt() {
      const sourceFolder = getInputValue('compressSource');
      const outputFolder = getInputValue('compressOutput');
      
      if (!sourceFolder) {
        showToast('Please select a source folder!', 'error');
        return;
      }
      
      setStatus('Merging files to TXT...', true);
      document.getElementById('txtBtn').disabled = true;
      
      try {
        const result = await api('/api/compress/txt', {
          method: 'POST',
          body: JSON.stringify({ sourceFolder, outputFolder })
        });
        
        if (result.success) {
          showToast(`Files merged: ${result.fileCount}, Skipped: ${result.skipCount}\nSaved to: ${result.outputPath}`);
          const folderName = sourceFolder.split(/[/\\]/).pop();
          addLog('compress-txt', `ÂêàÂπ∂ ${result.fileCount} ‰∏™Êñá‰ª∂ (${folderName})`, result.outputPath);
        } else {
          showToast(result.error || 'Compression failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('txtBtn').disabled = false;
    }

    async function extractZipBase64() {
      const inputFile = getInputValue('extractInput');
      const outputFolder = getInputValue('extractOutput');
      
      if (!inputFile) {
        showToast('Please select an input file!', 'error');
        return;
      }
      
      setStatus('Extracting ZIP+Base64...', true);
      document.getElementById('extractZipBtn').disabled = true;
      
      try {
        const result = await api('/api/extract/zip-base64', {
          method: 'POST',
          body: JSON.stringify({ inputFile, outputFolder })
        });
        
        if (result.success) {
          showToast(`Extracted to: ${result.outputPath}`);
          const fileName = inputFile.split(/[/\\]/).pop();
          addLog('extract-zip', `Extracted ${fileName} successfully`, result.outputPath);
        } else {
          showToast(result.error || 'Extraction failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('extractZipBtn').disabled = false;
    }

    async function extractTxt() {
      const inputFile = getInputValue('extractInput');
      const outputFolder = getInputValue('extractOutput');
      
      if (!inputFile) {
        showToast('Please select an input file!', 'error');
        return;
      }
      
      setStatus('Extracting TXT...', true);
      document.getElementById('extractTxtBtn').disabled = true;
      
      try {
        const result = await api('/api/extract/txt', {
          method: 'POST',
          body: JSON.stringify({ inputFile, outputFolder })
        });
        
        if (result.success) {
          showToast(`Extracted ${result.fileCount} files to: ${result.outputPath}`);
          const fileName = inputFile.split(/[/\\]/).pop();
          addLog('extract-txt', `Extracted ${result.fileCount} files (${fileName})`, result.outputPath);
        } else {
          showToast(result.error || 'Extraction failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('extractTxtBtn').disabled = false;
    }

    async function downloadFile() {
      const url = getInputValue('downloadUrl');
      if (!url) {
        showToast('Please enter a GitHub file URL!', 'error');
        return;
      }
      
      setStatus('Downloading file...', true);
      document.getElementById('downloadBtn').disabled = true;
      
      try {
        const result = await api('/api/github/download-file', {
          method: 'POST',
          body: JSON.stringify({ url })
        });
        
        if (result.success) {
          showToast(`File downloaded to: ${result.path}`);
          const fileName = result.path.split(/[/\\]/).pop();
          addLog('download', `Downloaded file ${fileName} successfully`, result.path);
        } else {
          showToast(result.error || 'Download failed', 'error');
        }
      } catch (e) {
        showToast('Error: ' + e.message, 'error');
      }
      
      setStatus('Ready');
      document.getElementById('downloadBtn').disabled = false;
    }

    init();
  </script>
</body>
</html>
